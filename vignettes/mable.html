<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>\setcounter{section}{0}</p>

<h1>Introduction</h1>

<p>Any continuous density function \(f\) on a known closed interval \([a,b]\) can be approximated by Bernstein polynomial \(f_m(x; p)=(b-a)^{-1}\sum_{i=0}^m p_i\beta_{mi}[(x-a)/(b-a)]\), where \(p_i\ge 0\), \(\sum_{i=0}^m p_i=1\) and \(\beta_{mi}(u)=(m+1){m\choose i}u^i(1-u)^{m-i}\), \(i=0,1,\ldots,m\), is the beta density with shapes \((i+1, m-i+1)\). This provides a way to approximately model the unknwon underlying density with a mixture beta model with an appropriate \emph{model degree} \(m\) and solve a nonparametric or semiparametric statistical problem &ldquo;parametrically&#39;&#39; using the maximum likelihood method. For instance, based on one-sample data, \(x_1,\ldots,x_n\), one can estimate a nonparametric density \(f\) parametrically by maximizing the approximate likelihood \(\ell(p)=\sum_{j=0}^n\log f_m(x_j; p)\) with respect to \(p\) [@Guan-jns-2015]. </p>

<p>Since the Bernstein polynomial model of degree \(m\) is nested in the model of degree \(m+1\), the maximum likelihood is increasing in \(m\). The increase is negligible when the model becomes overfitting. Therefore an optimal degree can be chosen as the change-point of the log likelihood ratios over a set of consecutive candidate model degrees. </p>

<p>This approach works surprisingly well for even more complicated models and data. With an estimate \(\hat p=(\hat p_0,\ldots,\hat p_m)\) of \(p\) one can estimate the cumulative distribution function \(F\) by
\(\hat F(x)=F_m(x;\hat p)=\sum_{i=0}^m \hat p_i B_{mi}[(x-a)/(b-a)]\), where \(B_{mi}(u)=\int_0^u\beta_{mj}(t)dt\), \(i=0,\ldots,m\), is the beta distribution function with shapes \((i+1,m-i+1)\). This manual will illustrate the use of the R package \texttt{mable} for obtaining not only smooth estimates of density, cumulative distribution, and survival functions but also estimates of parameters such as regression coefficients. </p>

<h1>One-sample Problems</h1>

<h2>Raw Data</h2>

<p>Let \(x_1,\ldots,x_n\) be a sample from a population with cumulative distribution function \(F\) and density function \(f\) on \([a,b]\). If \([a,b]\) is unknown we choose \([a,b]\supset [x_{(1)},x_{(n)}]\), where \(x_{(1)}\) and \(x_{(n)}\) are the minimum and maximum statistics, respectively. </p>

<h3>Example: Vaal River Annual Flow Data</h3>

<p>For the annual flow data of Vaal River at Standerton as given by Table 1.1 of @Linhart-and-Zucchini-model-selection-book give the flow in millions of cubic metres, </p>

<pre><code class="r">data(Vaal.Flow)
head(Vaal.Flow, 3)
</code></pre>

<pre><code>##   Year Flow
## 1 1905  222
## 2 1906 1094
## 3 1907  452
</code></pre>

<p>we want to estimate the density and the distribution functions of annual flow</p>

<pre><code class="r">vaal&lt;-mable(Vaal.Flow$Flow, M = c(2,100), interval = c(0, 3000), IC = &quot;all&quot;,
       controls = mable.ctrl(sig.level = 1e-8, maxit = 2000, eps = 1.0e-9))
</code></pre>

<p>Here we truncate the density by \texttt{interval=c(0, 3000)} and choose an optimal degree \(m\) among the candidate degrees M[1]:M[2] using the method of change-point. The maximum number of iterations is \texttt{maxit} and the convergence criterion is \texttt{eps} for each \(m\) of M[1]:M[2]. The search of an optimal degree stops when the \(p\)-value \texttt{pval} of change-point test falls below the specified significance level \texttt{sig.level} or the largest degree, M[2], has been reached. If the latter occurs a warning message shows up. In this case we should check the last value of \texttt{pval}. In the above example, we got warning message and the last \texttt{pval}, 1.3396916 &times; 10<sup>-8</sup>, which is small enough. The selected optimal degree is \(m=\) 19. One can also look at the Bayesian information criteria, \texttt{BIC}, and other information criteria, Akaike information criterion \texttt{AIC} and Hannan–Quinn information criterion \texttt{QHC}, at each candidate degree. These information criteria are not reliable due to the difficulty of determining the model dimension. The \texttt{plot} method for \texttt{mable} class object can visualize some of the results. </p>

<pre><code class="r">op &lt;- par(mfrow = c(1,2))
layout(rbind(c(1, 2), c(3, 3)))
plot(vaal, which = &quot;likelihood&quot;, cex = .5)
plot(vaal, which = &quot;change-point&quot;, lgd.x = &quot;topright&quot;)
hist(Vaal.Flow$Flow, prob = TRUE, xlim = c(0,3000), ylim =c(0,.0022), breaks =100*(0:30), 
    main = &quot;Histogram and Densities of the Annual Flow of Vaal River&quot;,
    border = &quot;dark grey&quot;,lwd = 1, xlab = &quot;Flow&quot;, ylab = &quot;Density&quot;, col =&quot;light grey&quot;)
lines(density(x&lt;-Vaal.Flow$Flow, bw = &quot;nrd0&quot;, adjust = 1), lty = 2, col = 2,lwd = 2)
lines(y&lt;-seq(0, 3000, length=100), dlnorm(y, mean(log(x)), sqrt(var(log(x)))), 
    lty = 4, col = 4, lwd = 2)
plot(vaal, which = &quot;density&quot;, add = TRUE, lwd = 2)
legend(&quot;topright&quot;, lty = c(1, 4, 2), col = c(1, 4, 2), bty = &quot;n&quot;,lwd = 2, 
c(expression(paste(&quot;MABLE: &quot;,hat(f)[B])), expression(paste(&quot;Log-Normal: &quot;,hat(f)[P])),
    expression(paste(&quot;KDE: &quot;,hat(f)[K]))))
</code></pre>

<p><img src="data:image/png;base64,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" title="Vaal River Annual Flow Data\label{fig:vaal-river-data-plot}" alt="Vaal River Annual Flow Data\label{fig:vaal-river-data-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<p>In Figure \ref{fig:vaal-river-data-plot}, the unknown density \(f\) is estimated by \texttt{MABLE}  \(\hat f_B\) using optimal degrees \(m=\) 19 selected using the exponential change-point method, the parametric estimate using \texttt{Log-Normal} model and the kernel density estimate \texttt{KDE}: \(\hat f_K\).</p>

<p>We can also look at the plots of AIC, BIC, and QHC, and likelihood ration(LR) of gamma change-point. </p>

<pre><code class="r">M &lt;- vaal$M[1]:vaal$M[2]
aic &lt;- vaal$ic$AIC
bic &lt;- vaal$ic$BIC
qhc &lt;- vaal$ic$QHC
vaal.gcp &lt;- optim.gcp(vaal) # choose m by gamma change-point model
lr &lt;- vaal.gcp$lr
plot(M, aic, cex = 0.7, col = 1, xlab = &quot;m&quot;, ylab = &quot;&quot;, ylim = c(ymin&lt;-min(aic,bic,qhc,lr),
      ymax&lt;-max(aic,bic,qhc,lr)), main = &quot;AIC, BIC, QHC, and LR&quot;)
points(M, bic, pch = 2, cex = 0.7, col = 2)
points(M, qhc, pch = 3, cex = 0.7, col = 3)
points(M[-1], lr, pch = 4, cex = 0.7, col = 4)
segments(which.max(aic)+M[1]-1-&gt;m1, ymin, m1, max(aic), lty = 2)
segments(which.max(bic)+M[1]-1-&gt;m2, ymin, m2, max(bic), lty = 2, col = 2)
segments(which.max(qhc)+M[1]-1-&gt;m3, ymin, m3, max(qhc), lty = 2, col = 3)
segments(which.max(lr)+M[1]-&gt;m4, ymin, m4, max(lr), lty = 2, col = 4)
axis(1, c(m1,m2, m3, m4),  as.character(c(m1,m2,m3,m4)), col.axis = 4)
legend(&quot;topright&quot;, pch=c(1,2,3,4), c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;QHC&quot;, &quot;LR&quot;), bty=&quot;n&quot;, col=c(1,2,3,4))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAEgCAMAAADi9tZbAAABa1BMVEUAAAAAADoAAGYAIoEAOjoAOmYAOpAAPKQAZrYOAAAOZrYielwiiIEil9Yil9gil+Yil+oil+4iqfIrPDorktsrl9guiNgul+YyAAA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNs6keE7l707l9JHl7FKl+ZOl71Ol8pOl+ZOl+5Oqc9OqfJOua1RADpcADpctv9h0E9mAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmkJBmkNtmtpBmtttmtv9y7v91l+Z1l+qG7v+J//+QOgCQOjqQOmaQZgCQZjqQZmaQkGaQtmaQtpCQttuQ27aQ29uQ2/+a3fKa7v+fZgC2ZgC2Zjq2tma2ttu225C22/+2//+9u+a925C9/7a9///bkDrbtmbbtpDb25Db27bb/7bb///ep9LezeTe/7bfU2v/tmb/tpD/25D/263/27b/3e7/7vL//7b//8b//9v//97///f///8uDpbUAAAACXBIWXMAAAsSAAALEgHS3X78AAATWUlEQVR4nO2diZ/jNhXHPQu7DKcod1pgWYb7Bk9paSkN1ywUKBBgyjFA0wJD8RBKp6H687Hu23Z86mXf77ObxJasePT1e3qSJaegKFAqlj4B1GFCYMCEwIAJgQETAgMmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGDKG9j+ojit327P71xR+vrTRXHynEm8PS+YPnWdSK/3vMDS/6QK2F/Es8V0e37vmr3vVuJdftn9q1H/vh7KG9huVbA65vVdf2Y61YmyDot71/F0tedkYwMLs0WVAFaIrQWVN7Bt8WyxFsBqY/v0db2jrn4pQWFXv8bT6z0Prun+JUWUAwuz0d1TRXF3w1J/sSru1va4f6E4+V4AjFsnf11UWQOr6/CPq1NRW6Lm9i88r1MlsJXgEabLut5fnGwMsFgxwnJqlML05AcEdrh2q1Puxlht3RRnXqr0UtLjhek30u9dFmvl0GLZ+BcJEz2jr9Scdqs7m9oG4y6xzZVOrqyBbWt/yP43AivuXg0Dtn/1Zx8vGDCO/t41Py7eht395QR/5WHKGZh2UpbLe/i8bvWVn2M8Yul8z0sP/n4uMjgu0cr2+vndP/yDWxi35SSwO1evn0fNc17lDEwGdKmgQlK4FDwSQcerK1VAKujYFg/oKysLWMIlighzPWcFxJQzsC2/oCUQerOy7I0lGz8XT1fA61KssD7IdiML0cC8oEMUIXJvCww60mLOjrJKOnU7xh6wu6qb5afLjvMnVg+ssD7MVsf9J8/VLaUGxsP6757HgMmO/JLKGFhSu/vNvVcv/fWn436srZg8BRDY7Xc2g9IPy5abAAJ7tIXAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIAJgQETAgMmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTEOAFagpNCGwAceiUkJgwJQzMCL/oyzlDKymhbx8ZQ0MeYXKFpjwh4QgNVd5ApO02Csh2JTZyhMYp0XkJ4VuQHFHpDyAhUCIYkaIwYfMcgHmxIOCkvCHeoM1Z8iLZgPMMR7TbBFKTfhBVARy5OBun9xQunviSqyv9h+GlAkwp8dFgk/KNRJCj7Fv5o4Q3jx7JoBt2brpS49YHsCk4yMai9nv5ztGXtSurP3DXz1zzYBxS6P7i3WQuaWsIefRQcb9WcxSeY8y/HCB7e5fX64ZsJvoo+GWB+YG8I0odBt2XMxcYNszenPKgUUfIZEBMM1LWliXA46rJbPbMP7cljtXNbD4cycyAKYNJvSHcSrHxssRx3S5BtCGpdISBxzrKOOW8bk5zTxKTKkJ5HF2pPc/YQ9Mun3yxcz7YQk1Ijm22KObIAN7JIer8gbWJKLuvRxraxYXXGDU7m9P/lXZCDQwLmljoKFV3bMuDKylprt1osEbWWURE4/MXCeH65e2sOaabqegx/G7nlWOcoAxULvHN6mO2NLA2iL3jiKQ3WJFLafIge0fblJDHUsDG2phJh+B2i+rrFdlYfevU8P14NswJ7c1CwSOPGC8Dbt3nRquHwxMPz2+x7HjSs3bARaBVEpiU7jEi3VquH4oMOVhI+Y7MzB1p0zNi4PpHwWwhuH6ocBuv33lvB9y7OiyOtJgZ39wYDWqqaLEaS3s8Bq3w3yQ41aT98PkDzBM04b1r2ptZjDtLK2lw/pm9a5rokN906AdhyYA1nE1bhcNrWfToB2NRgjr12zeSKSPtzwwM/8UaMgY0RhBx+U6+tMy2axxNpP1j0AjhPX7h5tMwvomZc2r7J51sEuszevmjM3z6XHsjMp7oNEBtuVhvexBB9H98KDjkgcYkWGv5dswt6CMvaINjHWUb8/XFjCn/3ykYX28tGyNzAImON3w0V+x6Y5QLQmsvf5Grd3WpRbLqFQSm6JtkWNTNFwUsaiFtTqpMavWHqzKTZaFbTkwdgdT3QZxw4NlXWJb3Y1dt7mOCFvAQgtze0x5W9jIkjO882vKvDbs3xtxy5mCa8MmUJa9aDtK3N67vj0vgEaJUykzXq7qftid3xdnk/XDBh/rjBKzDbNjoorNuxfdrKWB8UH9QjIqFC51KPEze3j7CfRipYWBcTilZCT/SXzsnTiAFE2Ro5leG1cE1u9YTqsUKAq5IWhwekSZm97loTWJhrT87savhzh5QGhRYKyKVT+f13gpAiaNhXiA9Ittbg49BbBTkAqQ16LAmEVRyagUztGM0xS23SgYPCe1XaJvbuqf7xJVI2nvy2TyALFe1ViinItz+EyZqYFFRCUTSi2UElBJ/XtHVqJu/MxXR7iaQ7OZPOCErAoYf9sePBdtYpfIzasqKyoNrdRMrA2rmg1UnTNiSl5Lpn2mYcfyqLHFDGQ7ZweY3LC1IDBZ+VVVM7MYVbQq1Ab7O0plWz6t0NyoZUQldVq3wn412fQ41RhThvrLum7ytDBVPSVfGlW/Vppe/ZkWlaRDLC8ZNz9/wwBznWUYXLJEPUOnS5AynWIWJtdEBHkXAabCAu4Ma1hsJUAl6LEdKnRUFkapgyVs9Gx6+loIGJi4wwpk6r4eB0YWBJZqw25ONmHmhYDxvnLNiC/bYKT4BqPHVnMUbJ9xiXbwyNVoblTnbz55Y2Q1LbKgS4xHiextu3SUaKIB3leu5KqoUqxBLPXCG6cNoxYTuVaxwdyUxXWYiGSNiuURezAVhQVsf3Hw1KZRgfF+l1BZX9NlReSqKGeBlC0fkGjijCmJokILo64ndVOcMxShx0yDwREzNn1KeUY7MadJRomrs+CAlq8YcnrhjlKEATKgcGuoch5+IKyPAbKcoWrjHAX+0faezcBkRRHuGYnZMUzJMiKRjds/NB2PhtJbvrzrWXY6tigLNaRR+Ve0S4JHIeJFxPxWHo9r6WGImJ/rQP08chRMxfetf1aR2rBKix+pacQ69HbHo+nrW86u5ey7H1uoUUPGrBIWZmIIdyl9IcytqogMR/hebl3KeWoLDGRgtMST9omyuIMUpEN072QJBlXkMKbt5ZxPtkW5dx6cFMdNNtXqocndj2WnwQJBFm7wIIOwdkyksbpzWrFC4SCaowPLMT9HHYLJEJgY9ig4scIy/Oh4pHFf1AYWmIqTouvfNiLXllzzSxvqYGAdF6Vzu9KDG5Raji4yXFFJOsQYVKXhqOg/1qCZ0iofUDSeNAeUhVzS7lSu9/dwSFbNJwYrC1P//jBmYdlV2rtaBVA/W/AHu1XXnHzAktlCRu2KGe9qCUWASXNTV7v0fvoBCda28Y/yTfpPh4n9Pe64idktQw9TV841T1M2EPg2laEwKYHFtdWq27V3DhgKrPuidFWR+lPlpsSOjAGrfGn/WJkyK8eEne9ptDhC9bBHkbCO0PEl4gQrJdGmtci6cCJ1kzymWV0tTNYIH8+QwLo/w8yCE6a5/tFym83AqO0v1auc7eFc3PasEx+geo0zSKd0lDPhRe1rOaS10M6L0kvttcynbopx0mm2+XlG2DbYEQJjEgP42re5l7ntIudQaLuDgXU61gz0Sh/mPRGrUY1oq8BHdrddv4vN5c/2iDYk8ym4NiYAFi5KFyGi465sD9fShjUBizrKA5xt3Aid2R6xUG1BjQMscmfUPrbQXpDGTKsZWKrxSsr7Asf/+uUEXy12zDj93glYY2fkaXCUeC7NKWzEzLE6kmcbIYD2KPEQOeGJ02eL2J4T2etPA5/Hkq7zSMrcwGpiNaoWCxMNWFJjA7M+6wER1XDGz8Otr5bZHpG+XUOGthS3Sxh2Hn2N4BJvz+/9LR9gNhM/fowHOmag0aquhrWafYHF7iJEhzqnBsaGpyJRvXWsuP0/j+wQxQJmRZNeJia/h9a4kiwBrPRu7sS8XGl9lT/GSWcE1nbswXFDf9lGFBkSodQfE+EKgHEFj/AzRuFv0GjNO6WbPDTCKDLqEuc2Tz9sPlnXhneJaJfojolwWe7J1CqhpRd6OD02r7+dAubUf3w8zCFO7TIiWgaY2zyMG3Qo+W7PBB1V4DipNWzsDAu7kwd8YBajuPxswWH2CaaB2dkWsjDie5r4kSMCC8aMPUOsqkjNk1IwCyzQCyDSWHoBc4jTPIDZG5MAa283ZTxpmrZEZRN9rzVuAyksCYtrbqKU/NK0jtfCWmX7R9sePWAswJfzhRKOL2j9qCnJDTLM7jb5xHXC8bZhbZJ3P52mTZ2O6xVLRqx+dY2KUtfCIhoAzJwKzcLCMpAb8KfGy4SRlXph0hjAuguBeWoY17eA1aYljKw2+YOADVbgEBFYkphiompM/4DjzNO6/UshB2ALBR1db6KW4kxKwseq5p6Gj8AsdRsyU7ZmHu8xJzQENkjL/3IBAjtE8k7Zkg8fQGBMVeRTShM/fKDtBHIAtrhMO9beohkj63E5RedVurFq2xkgMGp1x7pOlmz+sauGOV6xXfa6gfYZX/MDy+/Jd94MvPbsRE0hoCRmM2lgQelmklBwLgktYGHBtbl0G6bntXYK82XlingxZhBJI4nAsCYwmFNpPIM5gREat6+FgR04YVhkk52yesM/x7SNWDQq5xIxc5bbr5lZLUy11ZlZmFQ3YNboiDIynaCpuyvXlL9175r6E0vSkycdzesS4zaWB7AO41TGKNgHwv6TilRygrKscz3hx8wFcorQE0sCquGtuYgWsLBAmQAL58BVfo5gw3TKKit6qKgVR0SwGDoRYPoGXZzaEm1Y3jLW4bcl/hxVe46wCR0cU6EhFlo5xqi/1b0150/E05o5SsyfmbEO/yKPmQoTGxDm6+eVl3Nm+ZiAQm/4v7UdPYsq0ZTNHdZn/9xWz2mZaNsJ8qwKZ20Yixf1EvrKFGXFEQf0jUN/aWkwsEN/2j7CK482TKjyJfca66C6yk1QR0hsXrc9Z9Vp01qJKQcbaUuHAjv0h7djFpYTMKVgDpzca22bDREv+iOMbnShLaZLNGrFmtRrSwevDzvsp+3bVxc4Ry4NzA+0fVomnXXHvBHGwFjdNu3Qk5CazcIa7iFlCMymVZlAO4LAgiGfzDLaeTsXhtIIC/o6tmHpe0g5AoswaTtGjeKMFlcFTSnTfFFiJk+wPlhOa9YiyWzEzkvwtRMAi/+0/ZK31Yco6pcaRdRSwHG+fmxgdVh/AuGHt/vKjT06aNTJVeHXjhF07C/OBgHLsA3TCvtkHRS9JzHg6+0944T1l6fHCqy/JprBOFJYv337wT86YXSUwKaawThCWM8f/Bx5xPojDWyyGYw5zJo6RmBMk8xgzAHYkarpWR/9hcAmFaFjN2UIbHqNamQ5ADvWNkyK9J/aHRECm1o6XhznZ20R2BySQ/hjRCAIbAaZGy/DR6wQ2DzSQ8JDjSwHYI+KZIw/zMgQ2Kwafu8Fgc0uIu2sH7McgD0KbZiRmt7dc5QRgS2hAfOrENgCUi1ZH2YIbCGRnnPiENiC0jfMDvg7cwD2qErPYjwkZERgi8qEjF0NDYEtLmeUsZVZDsAe2TaMy4wydrIzBJaD1ChjdF2gKwSWiYhuzJojfQSWlcx0xtTfjsCyE9GtWUw5AEPZapnOiMBylLltFgiB5aqEkeUADNuwiFJrzBBYzooY2RhLZg96Ek5ECCwh2Zd26mGkBX2dn4QTEwKLS9/ntKthKLDIk3DiTxFoEAJLSo3mG+VgYahmjWph3Z+Eg+qpcduwiY5FpYTAgAmBAdOUwFBTaDpgnUsIshT2h6GnMPhPAFUAAgNWAAIDVgACA1YAAgNWAAIDVgACA1YAdn6BCYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBAdNAYLfnRTj9zdEbX3nZenNT/rIq3vZR8thfWwtJik/Caz+J9OHih4B6F7Bb8elkfQvYPWEO7ljGMGCsvranTTn+Sx572by5Ke/9xuatH3xw89p7vtVSSFrbYt3hJJK6XLP5lv0LuH1yQ7f9C7hhtOXBXcsYBoxNB96FP8pi9Of3/4aZlnzzUr74LvrG1363fvNz328uJK3dJ59at59EUnI2c/8Cdvev2dE9C7g8ebE+SB7ctYxhwPgJ11dZg5pc4sv0ja9+c/OfD/+orZCE9g9/XV+XHU4iod39nzKX2L8AaWG9C2CE5MFdyxgGjM3fHgTsf1/4EP3n+/oC254xR9LhJBLarTju/gXIhqd3AQyYPLhrGcta2O35Z75Mvv6RnsDqb98PtLCDLu5IAY9v6M2dKzgW1sHxNkeJbKHFm5/9cb8mZMun8Z0NaMOe4ZXUvwBpFr0L2M3dhrHfWmwJbRqAfelj67d++Fv62rtbC2k4gXWXk0jpci3MtG8B0sJ6F8AIyYO7lrFkP+zz7yyKdxDygX8t1g+rjxzSjWKB+aCO3Oz9MNTsQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIAJgQETAgMmBAZMRw9s//DnRXF2U/9f+kzG0fEDuzilu9Vp3/Ux2en4gT3c8P89VztkJwQGTAgMmBAYMCEwYDp6YMcmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkz/B4wwVyb2cFPgAAAAAElFTkSuQmCC" title="AIC and BIC based on Vaal River Data\label{fig:Vaal-River-data-AIC-BIC-plot}" alt="AIC and BIC based on Vaal River Data\label{fig:Vaal-River-data-AIC-BIC-plot}" style="display: block; margin: auto;" />
From Figure \ref{fig:Vaal-River-data-AIC-BIC-plot} we see that the gamma change-point method gives the same optimal degree \(m=\) 19 as the exponential method; BIC and QHC give the same degree \(m=\) 11; the degree \(m=\) 16 selected by AIC method is closer to the one selected by change-point methods. From this Figure we also see that unlike the LR plot the information criteria do not have clear peak points.</p>

<p>For any given degree \(m\), one can fit the data by specifying \texttt{M=m} in \texttt{mable()} to obtain an estimate of \(f\).</p>

<p>The \texttt{summary} method \texttt{summary.mable} prints and returns invisibly the summarized results.</p>

<pre><code class="r">summary(vaal)
</code></pre>

<pre><code>## Call: mable() for raw data
## Obj Class: mable 
## Input Data: Vaal.Flow$Flow 
## Dimension of data: 1 
## Optimal degree m: 19 
## P-value of Change-point: 1.339692e-08 
## Maximum loglikelihood: 56.81939 
## MABLE of p: can be retrieved using name &#39;p&#39; 
## Note: the optimal model degrees are selected by the method of change-point.
</code></pre>

<p>The mixing proportions, the coefficients of the Bernstein polynomials, \(p\) can be obtained as either \texttt{p&lt;-vaal$p} </p>

<pre><code class="r">p&lt;-vaal$p
p
</code></pre>

<pre><code>##  [1] 6.663951e-142  1.049278e-01  7.594313e-01  2.309036e-08  2.508441e-16
##  [6]  7.194500e-21  1.715117e-20  1.049294e-07  1.202354e-01  1.097612e-22
## [11]  3.689746e-96 2.261501e-228  0.000000e+00  0.000000e+00  0.000000e+00
## [16] 5.038909e-234  1.226874e-39  1.540542e-02 4.735457e-197  0.000000e+00
</code></pre>

<p>or \texttt{summary(res)$p}. </p>

<h2>Grouped Data</h2>

<p>With a grouped dataset, a frequency table of data from a continuous population, one can estimate the density from histogram using \texttt{mable.group()} with an optimal degree \(m\) chosen from \texttt{M[1]:M[2]} or with a given degree \(m\) using \texttt{M=m} [@Guan-2017-jns].</p>

<h3>Example: The Chicken Embryo Data</h3>

<p>Consider the chicken embryo data contain the number of hatched eggs on each day during the 21 days of incubation period. The times of hatching (\(n=43\)) are treated as grouped by intervals with equal width of one day. The data were studied first by @Jassim-et-al-1996. @Kuurman-et-al-2003 and @Lin-and-He-2006-bka also analyzed the data using the minimum Hellinger distance estimator, in addition to other methods assuming some parametric mixture models including Weibull model. </p>

<pre><code class="r">data(chicken.embryo)
head(chicken.embryo, 2)
</code></pre>

<pre><code>## $day
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21
## 
## $nT
##  [1]  6  5 11  2  2  3  0  0  0  0  1  0  0  0  1  0  1  5  1  4  1
</code></pre>

<pre><code class="r">a &lt;- 0
b &lt;- 21
day &lt;- chicken.embryo$day
nT &lt;- chicken.embryo$nT
embryo&lt;-mable.group(x = nT, breaks = a:b, M=c(2,100), interval = c(a, b), IC = &quot;aic&quot;,
    controls = mable.ctrl(sig.level = 1e-6,  maxit = 2000, eps = 1.0e-7))
</code></pre>

<pre><code class="r">Day &lt;- rep(day,nT)
op &lt;- par(mfrow = c(1,2), lwd = 2)
layout(rbind(c(1, 2), c(3, 3)))
plot(embryo, which = &quot;likelihood&quot;)
plot(embryo, which = &quot;change-point&quot;)
fk &lt;- density(x = rep((0:20)+.5, nT), bw = &quot;sj&quot;, n = 101, from = a, to = b)
hist(Day, breaks = seq(a,b,  length = 12), freq = FALSE, col = &quot;grey&quot;, border = &quot;white&quot;, 
     main = &quot;Histogram and Density Estimates&quot;)
plot(embryo, which = &quot;density&quot;, cex = 0.7, add = TRUE)
lines(fk, lty = 2, col = 2)
legend(&quot;top&quot;, lty = c(1:2), c(&quot;MABLE&quot;, &quot;Kernel&quot;), bty = &quot;n&quot;, col = c(1:2))
</code></pre>

<p><img src="data:image/png;base64,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" title="Chicken Embryo Data\label{fig:chicken-embryo-data-plot}" alt="Chicken Embryo Data\label{fig:chicken-embryo-data-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<p>We see in Figure \ref{fig:chicken-embryo-data-AIC-BIC-plot} that AIC and gamma change-point method give the same optimal degree as the one, \(m=\) 13, given by the exponential change-point method. However, BIC fails in choosing a useful model degree. </p>

<pre><code class="r">M &lt;- embryo$M[1]:embryo$M[2]
aic &lt;- embryo$ic$AIC
bic &lt;- embryo$ic$BIC
res.gcp &lt;- optim.gcp(embryo) # choose m by gamma change-point model
lr &lt;- res.gcp$lr
plot(M, aic, cex = 0.7, col = 1, xlab = &quot;m&quot;, ylab = &quot;&quot;, ylim = c(ymin&lt;-min(aic,bic,lr),
    ymax&lt;-max(aic,bic,lr)), main = &quot;AIC, BIC, and LR&quot;)
points(M, bic, pch = 2, cex = 0.7, col = 2)
points(M[-1], lr, pch = 3, cex = 0.7, col = 4)
segments(which.max(aic)+M[1]-1-&gt;m1, ymin, m1, max(aic), lty = 2)
segments(which.max(bic)+M[1]-1-&gt;m2, ymin, m2, max(bic), lty = 2, col = 2)
segments(which.max(lr)+M[1]-&gt;m3, ymin, m3, max(lr), lty = 2, col = 4)
axis(1, c(m1,m2, m3),  as.character(c(m1,m2,m3)), col.axis = 4)
legend(&quot;right&quot;, pch = 1:3, c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;LR&quot;), bty = &quot;n&quot;, col = c(1,2,4))
</code></pre>

<p><img src="data:image/png;base64,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" title="AIC and BIC based on Chicken Embryo Data\label{fig:chicken-embryo-data-AIC-BIC-plot}" alt="AIC and BIC based on Chicken Embryo Data\label{fig:chicken-embryo-data-AIC-BIC-plot}" style="display: block; margin: auto;" />
The results are summarized as follows.</p>

<pre><code class="r">summary(embryo)
</code></pre>

<pre><code>## Call: mable.group() for grouped data
## Obj Class: mable 
## Input Data: nT 
## Dimension of data: 1 
## Optimal degree m: 13 
## P-value of Change-point: 9.925959e-07 
## Maximum loglikelihood: -107.318 
## MABLE of p: can be retrieved using name &#39;p&#39; 
## Note: the optimal model degrees are selected by the method of change-point.
</code></pre>

<h2>Contaminated Data&ndash;Density Deconvolution</h2>

<p>Consider the additive measurement error model \(Y = X + \epsilon\), where \(X\) has an unknown distribution \(F\), \(\epsilon\) has a known distribution \(G\), and \(X\) and \(\epsilon\) are independent. We want to estimate density \(f=F'\) based on independent observations, \(y_i = x_i + \epsilon_i\), \(i=1,\ldots,n\), of \(Y\), where \(x_i\)&#39;s and \(\epsilon_i\)&#39;s are unobservable. \texttt{mable.decon()} implements the method of @Guan-2019-mable-deconvolution and gives an estimate of the density \(f\) using the approximate Bernstein polynomial model.</p>

<h3>Example: A Simulated Normal Dataset</h3>

<pre><code class="r">set.seed(123)
mu &lt;- 1; sig &lt;- 2; a &lt;- mu - sig*5; b &lt;- mu + sig*5;
gn &lt;- function(x) dnorm(x, 0, 1)
n &lt;- 50;
x &lt;- rnorm(n, mu, sig); e &lt;- rnorm(n); y &lt;- x + e;
decn &lt;- mable.decon(y, gn, interval = c(a,b), M = c(5, 50))
</code></pre>

<pre><code class="r">op &lt;- par(mfrow = c(2,2), lwd = 2)
plot(decn, which = &quot;likelihood&quot;)
plot(decn, which = &quot;change-point&quot;, lgd.x = &quot;right&quot;)
plot(xx&lt;-seq(a, b, length = 100), yy&lt;-dnorm(xx, mu, sig), type = &quot;l&quot;, xlab = &quot;x&quot;,
     ylab = &quot;Density&quot;, ylim = c(0, max(yy)*1.1))
plot(decn, which = &quot;density&quot;, add = TRUE, lty = 2, col = 2)
# kernel density based on pure data
lines(density(x), lty = 5, col = 4)
legend(&quot;topright&quot;, bty = &quot;n&quot;, lty = c(1,2,5), col = c(1,2,4), c(expression(f),     
    expression(hat(f)),  expression(tilde(f)[K])))
plot(xx, yy&lt;-pnorm(xx, mu, sig), type = &quot;l&quot;, xlab = &quot;x&quot;, ylab = &quot;Distribution Function&quot;)
plot(decn, which = &quot;cumulative&quot;, add = TRUE, lty = 2, col = 2)
legend(&quot;bottomright&quot;, bty = &quot;n&quot;, lty = c(1,2), col = c(1,2), c(expression(F), 
    expression(hat(F))))
</code></pre>

<p><img src="data:image/png;base64,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" title="Simulated Normal Data\label{fig:simulated-normal-data-plot}" alt="Simulated Normal Data\label{fig:simulated-normal-data-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<h2>Interval Censored Data</h2>

<p>When data are interval censored, the &rdquo;\texttt{interval2}&#39;&#39; type observations are of the form \((l,u)\) which is the interval containing the event time. Data is uncensored if \(l = u\), right censored if \(u =\) \texttt{Inf}  or \(u =\) \texttt{NA}, and  left censored data if \(l =0\).  </p>

<p>Let \(f(t)\) and \(F(t)=1-S(t)\) be the density and cumulative distribution functions of the event time, respectively, on \((0, \tau)\), where \(\tau\le \infty\). If \(\tau\) is unknown or \(\tau=\infty\), then  \(f(t)\) on \([0,\tau_n]\) can be approximated by \(fm(t; p)=\tau_n^{-1}\sum_{i=0}^m p_i\beta_{mi}(t/\tau_n)\), where \(p_i\ge 0\), \(i=0,\ldots,m\), \(\sum_{i=0}^mp_i=1-p_{m+1}\), and \(\tau_n\) is the largest observation, either uncensored time, or right endpoint of interval/left censored, or left endpoint of right censored time. So we can approximate \(S(t)\) on \([0,\tau]\) by \(Sm(t; p)=\sum_{i=0}^{m+1} p_i \bar B_{mi}(t/\tau)\), where  \(\bar B_{mi}(u)=1-\int_0^u\beta_{mj}(t)dt\), \(i=0,\ldots,m\), is the beta survival function with shapes \((i+1,m-i+1)\), \(\bar B_{m,m+1}(t)=1\), \(p_{m+1}=1-\pi\), and \(\pi=F(\tau_n)\). For data without right-censored time, \(p_{m+1}=1-\pi=0\). The search for optimal degree \(m\) among \texttt{M=c(m0,m1)} using the method of change-point is stopped if either \texttt{m1} is reached or the test for change-point results in a p-value \texttt{pval} smaller than \texttt{sig.level}. @Guan-SIM-2020 proposed a method, as a special case of a semiparametric regression model, for estimating \(p\) with an optimal degree \(m\). The method is implemented in R function \texttt{mable.ic()}.  </p>

<h3>Example: The Breast Cosmesis Data</h3>

<p>Consider the breast cosmesis data as described in @Finkelstein-and-Wolfe-1985-biom is used to study the cosmetic effects of cancer therapy. The time-to-breast-retractions in months (\(T\)) were  subject to interval censoring and were measured for 94 women among them 46 received radiation only (\(X=0\)) (25 right-censored, 3 left-censored and 18 interval censored) and 48 received radiation plus chemotherapy (\(X=1\))  (13 right-censored, 2 left-censored and 33 interval censored). The right-censored event times were for those women who did not experienced cosmetic deterioration.   </p>

<p>Load package \texttt{coxinterval} to access Breast Cosmesis Data. We fit the two-sample data separately.</p>

<pre><code class="r">library(coxinterval) 
</code></pre>

<pre><code>## Loading required package: survival
</code></pre>

<pre><code>## Loading required package: timereg
</code></pre>

<pre><code class="r">bcos=cosmesis
head(bcos, 3)
</code></pre>

<pre><code>##   left right treat
## 1   45    NA    RT
## 2    6    10    RT
## 3    0     7    RT
</code></pre>

<pre><code class="r">bc.res0 &lt;- mable.ic(bcos[bcos$treat == &quot;RT&quot;,1:2], M = c(1,50), IC = &quot;none&quot;)
bc.res1 &lt;- mable.ic(bcos[bcos$treat == &quot;RCT&quot;,1:2], M = c(1,50), IC = &quot;none&quot;)
</code></pre>

<p>As the warning message suggested, we check the \texttt{pval}. The \texttt{pval} when the search stopped is 0.0452. </p>

<pre><code class="r">op &lt;- par(mfrow = c(2,2),lwd = 2)
plot(bc.res0, which = &quot;change-point&quot;, lgd.x = &quot;right&quot;)
plot(bc.res1, which = &quot;change-point&quot;, lgd.x = &quot;right&quot;)
plot(bc.res0, which = &quot;survival&quot;, xlab = &quot;Months&quot;, ylim = c(0,1), main = &quot;Radiation Only&quot;)
plot(bc.res1, which = &quot;survival&quot;, xlab = &quot;Months&quot;, main = &quot;Radiation and Chemotherapy&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="Breast Cosmesis Data\label{fig:Breast-Cosmesis-Data-plot}" alt="Breast Cosmesis Data\label{fig:Breast-Cosmesis-Data-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<h2>Multivariate Data</h2>

<p>A \(d\)-variate density \(f\) on a hyperrectangle \([a,b]=[a_1,b_1]\times \cdots\times[a_d,b_d]\) can be approximated by a mixture of \(d\)-variate beta densities on \([a,b]\), \(\beta_{mj}(x; a, b)=\prod_{i=1}^d\beta_{m_i,j_i}[(x_i-a_i)/(b_i-a_i)]/(b_i-a_i)\), with proportions \(p(j_1,\ldots,j_d)\), \(0\le j_i\le m_i, i=1,\ldots,d\). Because all the marginal densities can be approximated by Bernstein polynomials, we can choose optimal degree \(m_i\) based on observations of the \(i\)-th component of \(x\). For the \(i\)-th marginal density, an optimal degree is selected using \texttt{mable()}. Then fit the data using EM algorithm with the selected optimal degrees \(m=(m_1,\ldots,m_d)\) to obtain a vector \(p\) of the mixture proportions \(p(j_1,\ldots,j_d)\), arranged in the lexicographical order of \(j = (j_1,\ldots,j_d)\), \((p_0,\ldots,p_{K-1})\), where \(K=\prod_{i=1}^d (m_i+1)\). The proposed method of @Wang-and-Guan-2019 is implemented by function \texttt{mable.mvar()}.</p>

<h3>Example: The Old Faithful Data</h3>

<pre><code class="r">data(faithful)
head(faithful, 3)
</code></pre>

<pre><code>##   eruptions waiting
## 1     3.600      79
## 2     1.800      54
## 3     3.333      74
</code></pre>

<pre><code class="r">a &lt;- c(0, 40); b &lt;- c(7, 110)
#faith2 &lt;- mable.mvar(faithful, M = c(60,30), interval = cbind(a,b))
faith2 &lt;- mable.mvar(faithful, M = c(46,19), search =FALSE, interval = cbind(a,b))
</code></pre>

<pre><code class="r">plot(faith2, which = &quot;density&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="Density Estimate based on the Old Faithful Data\label{fig:Old-Faithful-Data-plot}" alt="Density Estimate based on the Old Faithful Data\label{fig:Old-Faithful-Data-plot}" style="display: block; margin: auto;" />
The density surface for two-dimensional data can be plot using the \texttt{plot} method (see Figure\ref{fig:Old-Faithful-Data-plot}). The summarized results are given below.</p>

<pre><code class="r">summary(faith2)
</code></pre>

<pre><code>## Call: mable.mvar() for multivariate data
## Obj Class: mable 
## Input Data: eruptions waiting 
## Dimension of data: 2 
## Optimal degrees:
##   eruptions waiting
## m        46      19
## P-value of Change-point: 
## Maximum loglikelihood: 507.5615 
## MABLE of p: can be retrieved using name &#39;p&#39; 
## Note: the optimal model degrees are selected by the method of change-point.
</code></pre>

<h1>Event Time Data with Covariates</h1>

<p>Let \(T\) be an event time and \(X\) be an associated \(d\)-dimensional covariate with distribution \(H(x)\) on \(\cal{X}\). We denote the marginal and the conditional survival functions of \(T\), respectively, by
 \(S(t) = \bar F(t)= 1- F(t)=\Pr(T > t)\) and \(S(t | x) = \bar F(t | x)=  1- F(t |  x)=\Pr(T > t |  X=x).\)
Let \(f(t |  x)\) denote the conditional density of a continuous \(T\) given \(X=x\). The conditional cumulative hazard function and odds ratio,   respectively,
 \(\Lambda(t |  x)=-\log S(t |  x)\) and \(O(t |  x)={S(t |  x)}/[{1-S(t |  x)}]\).
 We will consider the general situation where the event time is subject to interval censoring.  The observed data are \((X, Y)\), where \(Y=(Y_1,Y_2]\), \(0\le Y_1\le Y_2\le\infty\).
The reader is referred to @Huang-and-Wellner-1997 for a review and more references about interval censoring.
Special cases are right-censoring \(Y_2=\infty\), left-censoring \(Y_1=0\), and current status data.</p>

<h2>Cox Proportional Hazards Model</h2>

<p>Consider the Cox proportional hazard regression model [@Cox1972]
\begin{equation}\label{eq: Cox PH model-conditional survival function}
S(t |  x) =S(t | x; \gamma, f<em>0)=S_0(t)<sup>{\exp(\gamma<sup>T\tilde{x})},</sup></sup>
\end{equation}
where \(\gamma\in \mathbb{G}  \subset \mathbb{R}^d\), \(\tilde{x} =x -x_0\), \(x_0\) is any fixed covariate value, \(f_0(\cdot)=f(\cdot | x_0)\) is the unknown baseline density and  \(S_0(t)=\int_t^\infty f_0(s)ds\). Define $\tau=\inf{t: F(t |  x</em>{0})=1}$.
It is true that \(\tau\) is independent of \(x_0\), \(0<\tau\le\infty\), and \(f(t |  x)\) have the same support \([0,\tau]\) for all \(x\in \cal{X}\). 
Let \((x_i, y_i)=(x_i, (y_{i1}, y_{j2}])\), \(i=1,\dots,n\), be independent observations of \((X, Y)\) and
\(\tau_n\ge y_{(n)}=\max\{y_{i1}, y_{j2}: y_{j2}<\infty;\, i,j=1,\dots,n\}\). 
Given any \(x_0\), denote \(\pi=\pi(x_0)=1-S_0(\tau_n)\). For integer \(m\ge 1\) we define \(\mathbb{S}_m\equiv \{(u_0,\ldots,u_m)^T\in \mathbb{R}^{m+1}: u_i\ge 0, \sum_{i=0}^m u_i=1.\}.\)
@Guan-SIM-2020 propose to approximate \(f_0(t)\)   on \([0,\tau_n]\)  by \(f_m(t; p) = \tau_n^{-1}\sum_{i=0}^{m} p_i\beta_{mi}(t/\tau_n)\), where \(p=p(x_0)=(p_0,\ldots,p_{m+1})\)  are subject to constraints   \(p\in \mathbb{S}_{m+1}\) and \(p_{m+1}=1-\pi\).
 Here the dependence of \(\pi\) and \(p\) on \(x_0\) will be suppressed.
If \(\pi< 1\),  although we cannot estimate the values of \(f_0(t)\)  on \((\tau_n,\infty)\), we can put an arbitrary guess on them such as
\(f_m(t; p)=  p_{m+1} \alpha(t-\tau_n)\), \(t\in (\tau_n,\infty)\), where  \(\alpha(\cdot)\) is a density on \([0,\infty)\) such that \((1-\pi)\alpha(0)=(m+1)p_m/\tau_n\) so that \(f_m(t; p)\) is continuous at \(t=\tau_n\), e.g., \(\alpha(t)=\alpha(0)\exp[-\alpha(0)t]\).  If \(\tau\) is finite and known we choose \(\tau_n=\tau\) and specify \(p_{m+1}=0\). Otherwise,  we choose \(\tau_n=y_{(n)}\). For data without right-censoring or covariate
we also have to specify \(p_{m+1}=0\) due to its unidentifiability. </p>

<p>The above method is implemented in function \texttt{mable.ph()} which returns maximum approximate Bernstein likelihood estimates of \((\gamma, p)\) with an optimal model degree \(m\) and a prespecified \(m\),  respectively. With a efficient estimate of \(\gamma\) obtained using other method, \texttt{maple.ph()} can be used to get an optimal degree \(m\) and a mable of \(p\). </p>

<p>The \texttt{plot} method \texttt{plot.mable_reg()} for class \texttt{mable_reg} object returned by all the above functions produces graphs of the loglikelihoods at \(m\) in a set \texttt{M[1]:M[2]} of consecutive candidate model degrees, the likelihood ratios of change-point at \(m\) in \texttt{(M[1]+1):M[2]},  estimated density and survival function on the truncated \texttt{support}=\([0,\tau_n]\).</p>

<h3>Example: Ovarian Cancer Survival Data</h3>

<p>The Ovarian Cancer Survival Data is included in package \texttt{survival}.</p>

<pre><code class="r">futime2 &lt;- ovarian$futime
futime2[ovarian$fustat==0] &lt;- Inf
ovarian2 &lt;- data.frame(age = ovarian$age, futime1 = ovarian$futime, futime2 = futime2)
head(ovarian2, 3)
</code></pre>

<pre><code>##       age futime1 futime2
## 1 72.3315      59      59
## 2 74.4932     115     115
## 3 66.4658     156     156
</code></pre>

<pre><code class="r">ova&lt;-mable.ph(cbind(futime1, futime2) ~ age, data = ovarian2, M = c(2,35), g = .16, x0=35)
</code></pre>

<pre><code class="r">summary(ova)
</code></pre>

<pre><code>## Call: ph(cbind(futime1, futime2) ~ age)
## Data: ovarian2 
## Obj Class: mable_reg 
## Dimension of response: 1 
## Dimension of covariate: 1 
## Optimal degree m: 23 
## P-value: 0.008999588 
## Maximum loglikelihood: -85.73586 
## MABLE of p: can be retrieved using name &#39;p&#39; 
## 
##      Estimate   Std.Err   Z value Baseline x0
## age  0.176686  0.010522 16.791381          35
## 
## Note: the optimal model degree is selected by the method of change-point.
</code></pre>

<pre><code class="r">op &lt;- par(mfrow = c(2,2))
plot(ova, which = &quot;likelihood&quot;)
plot(ova, which = &quot;change-point&quot;)
plot(ova, y=data.frame(age=60), which=&quot;survival&quot;, type=&quot;l&quot;, xlab=&quot;Days&quot;, main=&quot;Age = 60&quot;)
plot(ova, y=data.frame(age=65), which=&quot;survival&quot;, type=&quot;l&quot;, xlab=&quot;Days&quot;, main=&quot;Age = 65&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="Ovarian Cancer Data\label{fig:ovarian-Data-plot}" alt="Ovarian Cancer Data\label{fig:ovarian-Data-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<p>Alternatively we can use \texttt{mable.reg()}.</p>

<pre><code class="r">ova1 &lt;- mable.reg(cbind(futime1, futime2) ~ age, data = ovarian2, M = c(2,35))
</code></pre>

<h2>Accelerated Failure Time Model</h2>

<p>The AFT model can be specified as
\begin{equation}\label{eq: AFT model in terms of density}
f(t\mid x)=f(t\mid x;\gamma)=e<sup>{-\gamma<sup>T</sup></sup> x}f(te<sup>{-\gamma<sup>T</sup></sup> x}\mid 0),\quad t\in[0,\infty),
\end{equation}
where \(\gamma\in \mathbb{G}\subset \mathbb{R}^d\). Let \(\gamma_0\in \mathbb{G}\) be the true value of \(\gamma\).
The AFT model (\ref{eq: AFT model in terms of density}) is equivalent to
\[S(t\mid x;\gamma)=S(te^{-\gamma^T x}\mid 0),\quad t\in[0,\infty).\]
Thus this is actually a scale regression model.
The AFT model can also be written as linear regression \(\log(T)=\gamma^T x +\varepsilon\). It is clear that one can choose any \(x_0\) in \(\mathcal{X}\) as baseline by transform \(\tilde{x}=x-x_0\). If \(f(t\mid 0)\) has support \([0,\tau_0)\), \(\tau_0\le\infty\), then 
\(f(t\mid x)\) has support \([0,\tau_0 e^{\gamma_0^T x})\).  We define \(\tau=\max\{\tau_0 e^{\gamma_0^T x}: x\in\mathcal{X}\}\) if \(\tau_0<\infty\) and \(\tau=\infty\) otherwise.
The above AFT model can also be written as
\[f(t\mid x;\gamma)=e^{-\gamma^T {x}} f_0(te^{-\gamma^T {x}}), \quad
S(t\mid x;\gamma)=S_0(te^{-\gamma^T {x}}),\]
where   \(f_0(t)=f(t\mid 0)\) and \(S_0(t)=S(t\mid 0)=\int_t^\infty f_0(u)du\).</p>

<p>As in Cox PH model, we choose \(\tau_n>y_{(n)}= \max\{y_{i1}, y_{j2}: y_{j2}<\infty;\, i,j=1,\dots,n\}\) so that \(S(\tau_n)\) and \(\max_{x\in\mathcal{X}} S(\tau_n\mid x)\) are believed very small.
Then we approximate \(f_0(t)\) and \(S_0(t)\) on \([0,\tau_n]\), respectively, by
\begin{align<em>}
f<em>0(t)&amp;\approx f_m(t; p)=\frac{1}{\tau_n}\sum</em>{j=0}<sup>m</sup> p<em>j\beta</em>{mj}\Big(\frac{t}{\tau<em>n}\Big),\quad t\in[0,\tau_n];\
S_0(t)&amp;\approx S_m(t; p)= \sum</em>{j=0}<sup>{m}</sup> p<em>j \bar B</em>{mj}\Big(\frac{t}{\tau_n}\Big),\quad  t\in[0,\tau_n],
\end{align</em>}
where \(S_m(\infty; p)=0\), and \(p= (p_0,\ldots,p_{m})^T\in \mathbb{S}_{m}\).
  Then \(f(t\mid x; \gamma)\) and \(S(t\mid x; \gamma)\)  can be approximated, respectively, by
\begin{align}\nonumber
f<em>m(t\mid x; \gamma, p)&amp;=e<sup>{-\gamma<sup>T</sup></sup> {x}}f_m\Big(te<sup>{-\gamma<sup>T</sup></sup> {x}}; p\Big)\
&amp;=
 \frac{e<sup>{-\gamma<sup>T</sup></sup> {x}}}{\tau_n}\sum</em>{j=0}<sup>m</sup> p<em>j\beta</em>{mj}\Big(e<sup>{-\gamma<sup>T</sup></sup> {x}}\frac{t}{\tau<em>n}\Big),\quad t\in[0,\tau_ne<sup>{\gamma<sup>T</sup></sup> {x}}];\nonumber
S_m(t\mid x;\gamma,p)&amp;=S_m\Big(te<sup>{-\gamma<sup>T</sup></sup> {x}}; p\Big)\
&amp;=  \sum</em>{j=0}<sup>{m}</sup> p<em>j\bar B</em>{mj}\Big(e<sup>{-\gamma<sup>T</sup></sup> {  x}}\frac{t}{\tau_n}\Big),\quad t\in[0,\tau_ne<sup>{\gamma<sup>T</sup></sup> {x}}].
\end{align}
@Guan-2019-mable-aft&#39;s proposal is implemented by functions \texttt{mable.aft()} and \texttt{maple.aft()}.</p>

<h3>Example: Breast Cosmesis Data</h3>

<pre><code class="r">bcos2 &lt;- data.frame(bcos[,1:2], x = 1*(bcos$treat == &quot;RCT&quot;))
</code></pre>

<pre><code class="r">g &lt;- 0.41 # Hanson and Johnson 2004, JCGS
aft.res&lt;-mable.aft(cbind(left, right) ~ x, data = bcos2, M =c(1, 30), g=.41,  tau =100, x0=1)
</code></pre>

<pre><code class="r">summary(aft.res)
</code></pre>

<pre><code>## Call: aft(cbind(left, right) ~ x)
## Data: bcos2 
## Obj Class: mable_reg 
## Dimension of response: 1 
## Dimension of covariate: 1 
## Optimal degree m: 5 
## P-value: 0.008900705 
## Maximum loglikelihood: -144.4767 
## MABLE of p: can be retrieved using name &#39;p&#39; 
## 
##    Estimate   Std.Err   Z value Baseline x0
## x  0.381874  0.097193 -3.929023           1
## 
## Note: the optimal model degree is selected by the method of change-point.
</code></pre>

<pre><code class="r">op &lt;- par(mfrow = c(1,2), lwd = 1.5)
plot(x = aft.res, which = &quot;likelihood&quot;)
plot(x = aft.res, y = data.frame(x = 0), which = &quot;survival&quot;, type = &quot;l&quot;, col = 1, 
    main = &quot;Survival Function&quot;)
plot(x = aft.res, y = data.frame(x = 1), which = &quot;survival&quot;, lty = 2, col = 1, add = TRUE)
legend(&quot;bottomleft&quot;, bty = &quot;n&quot;, lty = 1:2, col = 1, c(&quot;Radiation Only&quot;, 
    &quot;Radiation and Chemotherapy&quot;), cex = .7)
</code></pre>

<p><img src="data:image/png;base64,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" title="AFT Model Fit for Breast Cosmesis Data\label{fig:Breast-Cosmesis-Data-aft-plot}" alt="AFT Model Fit for Breast Cosmesis Data\label{fig:Breast-Cosmesis-Data-aft-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<p>Alternatively we can use \texttt{mable.reg()}.</p>

<pre><code class="r">aft.res1 &lt;- mable.reg(cbind(left, right) ~ x, data = bcos2, &#39;aft&#39;, M = c(1, 30), 
      g=.41, tau=100, x0=1)
</code></pre>

<h1>Two-sample Data</h1>

<p>In addition to the PH and AFT regression models with single binary covariate, other two-sample semiparametric models can be estimated using the maximum approximate Bernstein/Beta likelihhod method.</p>

<h2>Density Ratio Model</h2>

<p>Two-sample density ratio(DR) model
(see for example, @QinZhang1997 and @Qin-and-Zhang-2005) is useful for fitting case-control data.
 Suppose that the densities \(f_0\) and \(f_1\) of \(X_0\) and \(X_1\), respectively, satisfy the following density ratio model (see @CHENG-and-CHU-Bernoulli-2004 and @Qin-and-Zhang-2005, for example)
\begin{equation}\label{eq: exponential tilting model}
f_1(x)=f(x;\bm\alpha)=f_0(x)\exp{\bm\alpha<sup>T</sup> \tilde r(x)},
\end{equation}
where \(\bm\alpha=(\alpha_0,\ldots,\alpha_d)^T \in\mathcal{A}\subset R^{d+1}\), and \(\tilde r(x)=(1, r^T(x))^T\) with linearly independent components. @Guan-arXiv-2021-mable-dr-model proposed to approximate the \emph{baseline} density \(f_0\) by Bernstein polynomial and to estimate \(f_0\) and \(\bm\alpha\) using the maximum approximate Bernstein/Beta likelihood estimation. This method is implemented by function \texttt{mable.dr()} and \texttt{maple.dr()} in which \(\bm\alpha\) is a given estimated value such as the one obtained by the logistic regression as described in @QinZhang1997 and @Qin-and-Zhang-2005.</p>

<h3>Example: Coronary Heart Disease Data</h3>

<pre><code class="r"># Hosmer and Lemeshow (1989):                                           
# ages and the status of coronary disease (CHD) of 100 subjects         
x&lt;-c(20, 23, 24, 25, 26, 26, 28, 28, 29, 30, 30, 30, 30, 30, 32,        
32, 33, 33, 34, 34, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 39,         
40, 41, 41, 42, 42, 42, 43, 43, 44, 44, 45, 46, 47, 47, 48, 49,         
49, 50, 51, 52, 55, 57, 57, 58, 60, 64)                                 
y&lt;-c(25, 30, 34, 36, 37, 39, 40, 42, 43, 44, 44, 45, 46, 47, 48,        
48, 49, 50, 52, 53, 53, 54, 55, 55, 56, 56, 56, 57, 57, 57, 57,         
58, 58, 59, 59, 60, 61, 62, 62, 63, 64, 65, 69) 
a&lt;-20; b&lt;-70
regr&lt;-function(x) cbind(1,x)                                            
chd.mable&lt;-mable.dr(x, y, M=c(1, 15), regr, interval = c(a,b))   
</code></pre>

<pre><code class="r">z&lt;-seq(a,b,length=512)
f0hat&lt;-dmixbeta(z, p=chd.mable$p, interval=c(a, b))
rf&lt;-function(x) chd.mable$regr((x-a)/(b-a))
f1hat&lt;-dtmixbeta(z, p=chd.mable$p, alpha=chd.mable$alpha, 
                 interval=c(a, b), regr=rf)
op&lt;-par(mfrow=c(1,2),lwd=1.2, cex=.7, mar=c(5,4,1,1))
hist(x, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;Age&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b), ylim=c(0,.055), main=&quot;Control&quot;)
lines(z, f0hat, lty=1, col=1)
hist(y, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;Age&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b), ylim=c(0,.055), main=&quot;Case&quot;)
lines(z, f1hat, lty=1, col=1)
</code></pre>

<p><img src="data:image/png;base64,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" title="DR Model Fit for Coronary Heart Disease  Data\label{fig:CHD-data-plot}" alt="DR Model Fit for Coronary Heart Disease  Data\label{fig:CHD-data-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<h3>Example: Pancreatic Cancer Biomarker Data</h3>

<p>For the logarithmic levels of CA 19-9 of the Pancreatic Cancer Data (@Wieand-et-al-1989-bka), the control group is used as baseline because the optimal model degree is smaller that the one using case as baseline.  </p>

<pre><code class="r">data(pancreas)
head(pancreas,3)
x&lt;-log(pancreas$ca199[pancreas$status==0])
y&lt;-log(pancreas$ca199[pancreas$status==1])
a&lt;-min(x,y); b&lt;-max(x,y)
M&lt;-c(1,29)
regr&lt;-function(x) cbind(1,x,x^2)                                            
m=maple.dr(x, y, M, regr=regr, interval=c(a,b), controls=mable.ctrl(sig.level=.001))$m
pc.mable&lt;-mable.dr(x, y, M=m, regr=regr, interval=c(a,b),
                  controls=mable.ctrl(sig.level=1/length(c(x,y))))
#pc.mable   
</code></pre>

<pre><code class="r">z&lt;-seq(a,b,length=512)
# baseline is &quot;case&quot;
f1hat&lt;-dmixbeta(z, p=pc.mable$p, interval=c(a, b))
rf&lt;-function(x) pc.mable$regr((x-a)/(b-a))
f0hat&lt;-dtmixbeta(z, p=pc.mable$p, alpha=pc.mable$alpha, 
                 interval=c(a, b), regr=rf)
op&lt;-par(mfrow=c(1,2),lwd=1.2, cex=.7, mar=c(5,4,1,1))
hist(x, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;log(CA19-9)&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b),  main=&quot;Control&quot;)
lines(z, f0hat, lty=1, col=1)
hist(y, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;log(CA19-9)&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b), ylim=c(0,.5), main=&quot;Case&quot;)
lines(z, f1hat, lty=1, col=1)
</code></pre>

<p><img src="data:image/png;base64,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" title="DR Model Fit for Pancreatic Cancer Biomarker Data\label{fig:pcb-data-plot}" alt="DR Model Fit for Pancreatic Cancer Biomarker Data\label{fig:pcb-data-plot}" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)
</code></pre>

<h2>References</h2>

</body>

</html>
