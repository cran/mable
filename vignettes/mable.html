<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Maximum Approximate Bernstein/Beta Likelihood Estimation in R package ‘mable’</title>
<style type="text/css">
/**
 * Prism.s theme ported from highlight.js's xcode style
 */
pre code {
  padding: 1em;
}
.token.comment {
  color: #007400;
}
.token.punctuation {
  color: #999;
}
.token.tag,
.token.selector {
  color: #aa0d91;
}
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #1c00cf;
}
.token.property,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #c41a16;
}
.token.inserted {
  background-color: #ccffd8;
}
.token.deleted {
  background-color: #ffebe9;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #9a6e3a;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #836c28;
}
.token.function,
.token.class-name {
  color: #DD4A68;
}
.token.regex,
.token.important,
.token.variable {
  color: #5c2699;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
</style>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  box-sizing: border-box;
}
body, .footnotes, code { font-size: .9em; }
li li { font-size: .95em; }
*, *:before, *:after {
  box-sizing: inherit;
}
pre, img { max-width: 100%; }
pre, pre:hover {
  white-space: pre-wrap;
  word-break: break-all;
}
pre code {
  display: block;
  overflow-x: auto;
}
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre) > code, code[class] { background-color: #F8F8F8; }
code.language-undefined, pre > code:not([class]) {
  background-color: inherit;
  border: 1px solid #eee;
}
table {
  margin: auto;
  border-top: 1px solid #666;
}
table thead th { border-bottom: 1px solid #ddd; }
th, td { padding: 5px; }
thead, tfoot, tr:nth-child(even) { background: #eee; }
blockquote {
  color: #666;
  margin: 0;
  padding-left: 1em;
  border-left: 0.5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC .numbered li { list-style: none; }
#TOC .numbered { padding-left: 0; }
#TOC .numbered ul { padding-left: 1em; }
table, .body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.footnote-ref a::before { content: "["; }
.footnote-ref a::after { content: "]"; }
section.footnotes::before {
  content: "";
  display: block;
  max-width: 20em;
}

@media print {
  body {
    font-size: 12pt;
    max-width: 100%;
  }
  tr, img { page-break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  pre { white-space: pre; }
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>
<body>
<div class="frontmatter">
<div class="title"><h1>Maximum Approximate Bernstein/Beta Likelihood Estimation in R package ‘mable’</h1></div>
<div class="author"><h2>Zhong Guan</h2></div>
<div class="date"><h3>24/09/2024</h3></div>
</div>
<div class="body">
<p>\setcounter{section}{0}</p>
<h1 id="introduction">Introduction</h1>
<p>Any continuous density function \(f\) on a known closed interval \([a,b]\) can be approximated by Bernstein polynomial \(f_m(x; p)=(b-a)^{-1}\sum_{i=0}^m p_i\beta_{mi}[(x-a)/(b-a)]\), where \(p_i\ge 0\), \(\sum_{i=0}^m p_i=1\) and \(\beta_{mi}(u)=(m+1){m\choose i}u^i(1-u)^{m-i}\), \(i=0,1,\ldots,m\), is the beta density with shapes \((i+1, m-i+1)\). This provides a way to approximately model the unknwon underlying density with a mixture beta model with an appropriate \emph{model degree} \(m\) and solve a nonparametric or semiparametric statistical problem ``parametrically’’ using the maximum likelihood method. For instance, based on one-sample data, \(x_1,\ldots,x_n\), one can estimate a nonparametric density `5B(f)5B` parametrically by maximizing the approximate likelihood `5B(\ell(p)=\sum_{j=0}^n\log f_m(x_j; p))5B` with respect to `5B(p)5B` [@Guan-jns-2015].</p>
<p>Since the Bernstein polynomial model of degree \(m\) is nested in the model of degree \(m+1\), the maximum likelihood is increasing in \(m\). The increase is negligible when the model becomes overfitting. Therefore an optimal degree can be chosen as the change-point of the log likelihood ratios over a set of consecutive candidate model degrees.</p>
<p>This approach works surprisingly well for even more complicated models and data. With an estimate \(\hat p=(\hat p_0,\ldots,\hat p_m)\) of \(p\) one can estimate the cumulative distribution function \(F\) by
\(\hat F(x)=F_m(x;\hat p)=\sum_{i=0}^m \hat p_i B_{mi}[(x-a)/(b-a)]\), where \(B_{mi}(u)=\int_0^u\beta_{mj}(t)dt\), \(i=0,\ldots,m\), is the beta distribution function with shapes \((i+1,m-i+1)\). This manual will illustrate the use of the R package \texttt{mable} for obtaining not only smooth estimates of density, cumulative distribution, and survival functions but also estimates of parameters such as regression coefficients.</p>
<h1 id="one-sample-problems">One-sample Problems</h1>
<h2 id="raw-data">Raw Data</h2>
<p>Let \(x_1,\ldots,x_n\) be a sample from a population with cumulative distribution function \(F\) and density function \(f\) on \([a,b]\). If \([a,b]\) is unknown we choose \([a,b]\supset [x_{(1)},x_{(n)}]\), where \(x_{(1)}\) and \(x_{(n)}\) are the minimum and maximum statistics, respectively. A lower bound for unimodal density is \(m_b=\mu(1-\mu)/\sigma^2-3\), where \(\mu\) and \(\sigma^2\) are, respectively, the mean and variance of the distribution after transformation \(Y=(X-a)/(b-a)\).</p>
<h3 id="example-vaal-river-annual-flow-data">Example: Vaal River Annual Flow Data</h3>
<p>For the annual flow data of Vaal River at Standerton as given by Table 1.1 of @Linhart-and-Zucchini-model-selection-book give the flow in millions of cubic metres,</p>
<pre><code class="language-r">data(Vaal.Flow)
head(Vaal.Flow, 3)
</code></pre>
<pre><code>##   Year Flow
## 1 1905  222
## 2 1906 1094
## 3 1907  452
</code></pre>
<p>we want to estimate the density and the distribution functions of annual flow</p>
<pre><code class="language-r">vaal&lt;-mable(Vaal.Flow$Flow, M = c(2,100), interval = c(0, 3000), IC = &quot;all&quot;,
       controls = mable.ctrl(sig.level = 1e-8, maxit = 2000, eps = 1.0e-9))
</code></pre>
<p>% the following hided data contain object vaal obtained by dput(vaal)</p>
<p>Here we truncate the density by \texttt{interval=c(0, 3000)} and choose an optimal degree \(m\) among the candidate degrees M[1]:M[2] using the method of change-point. The maximum number of iterations is \texttt{maxit} and the convergence criterion is \texttt{eps} for each \(m\) of M[1]:M[2]. The search of an optimal degree stops when the \(p\)-value \texttt{pval} of change-point test falls below the specified significance level \texttt{sig.level} or the largest degree, M[2], has been reached. If the latter occurs a warning message shows up. In this case we should check the last value of \texttt{pval}. In the above example, we got warning message and the last \texttt{pval}, 1.3396916 × 10<sup>-8</sup>, which is small enough. The selected optimal degree is \(m=\) 19. One can also look at the Bayesian information criteria, \texttt{BIC}, and other information criteria, Akaike information criterion \texttt{AIC} and Hannan–Quinn information criterion \texttt{QHC}, at each candidate degree. These information criteria are not reliable due to the difficulty of determining the model dimension. The \texttt{plot} method for \texttt{mable} class object can visualize some of the results.</p>
<pre><code class="language-r">op &lt;- par(mfrow = c(1,2))
layout(rbind(c(1, 2), c(3, 3)))
plot(vaal, which = &quot;likelihood&quot;, cex = .5)
plot(vaal, which = &quot;change-point&quot;, lgd.x = &quot;topright&quot;)
hist(Vaal.Flow$Flow, prob = TRUE, xlim = c(0,3000), ylim =c(0,.0022), breaks =100*(0:30), 
    main = &quot;Histogram and Densities of the Annual Flow of Vaal River&quot;,
    border = &quot;dark grey&quot;,lwd = 1, xlab = &quot;Flow&quot;, ylab = &quot;Density&quot;, col =&quot;light grey&quot;)
lines(density(x&lt;-Vaal.Flow$Flow, bw = &quot;nrd0&quot;, adjust = 1), lty = 2, col = 2,lwd = 2)
lines(y&lt;-seq(0, 3000, length=100), dlnorm(y, mean(log(x)), sqrt(var(log(x)))), 
    lty = 4, col = 4, lwd = 2)
plot(vaal, which = &quot;density&quot;, add = TRUE, lwd = 2)
legend(&quot;topright&quot;, lty = c(1, 4, 2), col = c(1, 4, 2), bty = &quot;n&quot;,lwd = 2, 
c(expression(paste(&quot;MABLE: &quot;,hat(f)[B])), expression(paste(&quot;Log-Normal: &quot;,hat(f)[P])),
    expression(paste(&quot;KDE: &quot;,hat(f)[K]))))
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Vaal River Annual Flow Data"  />
<p class="caption">Vaal River Annual Flow Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<p>In Figure \ref{fig:vaal-river-data-plot}, the unknown density \(f\) is estimated by \texttt{MABLE}  \(\hat f_B\) using optimal degrees \(m=\) 19 selected using the exponential change-point method, the parametric estimate using \texttt{Log-Normal} model and the kernel density estimate \texttt{KDE}: \(\hat f_K\).</p>
<p>We can also look at the plots of AIC, BIC, and QHC, and likelihood ration(LR) of gamma change-point.</p>
<pre><code class="language-r">M &lt;- vaal$M[1]:vaal$M[2]
aic &lt;- vaal$ic$AIC
bic &lt;- vaal$ic$BIC
qhc &lt;- vaal$ic$QHC
vaal.gcp &lt;- optim.gcp(vaal) # choose m by gamma change-point model
lr &lt;- vaal.gcp$lr
plot(M, aic, cex = 0.7, xlab = &quot;m&quot;, ylab = &quot;&quot;, main = &quot;AIC, BIC, QHC, and LR&quot;, 
      ylim = c(ymin&lt;-min(aic,bic,qhc,lr), ymax&lt;-max(aic,bic,qhc,lr)), col = 1)
points(M, bic, pch = 2, cex = 0.7, col = 2)
points(M, qhc, pch = 3, cex = 0.7, col = 3)
points(M[-1], lr, pch = 4, cex = 0.7, col = 4)
segments(which.max(aic)+M[1]-1-&gt;m1, ymin, m1, max(aic), lty = 2)
segments(which.max(bic)+M[1]-1-&gt;m2, ymin, m2, max(bic), lty = 2, col = 2)
segments(which.max(qhc)+M[1]-1-&gt;m3, ymin, m3, max(qhc), lty = 2, col = 3)
segments(which.max(lr)+M[1]-&gt;m4, ymin, m4, max(lr), lty = 2, col = 4)
axis(1, c(m1,m2, m3, m4),  as.character(c(m1,m2,m3,m4)), col.axis = 4)
legend(&quot;topright&quot;, pch=c(1,2,3,4), c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;QHC&quot;, &quot;LR&quot;), bty=&quot;n&quot;, col=c(1,2,3,4))
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAEgCAMAAADi9tZbAAABa1BMVEUAAAAAADoAAGYAIoEAOjoAOmYAOpAAPKQAZrYOAAAOZrYielwiiIEil9Yil9gil+Yil+oil+4iqfIrPDorktsrl9guiNgul+YyAAA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNs6keE7l707l9JHl7FKl+ZOl71Ol8pOl+ZOl+5Oqc9OqfJOua1RADpcADpctv9h0E9mAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmkJBmkNtmtpBmtttmtv9y7v91l+Z1l+qG7v+J//+QOgCQOjqQOmaQZgCQZjqQZmaQkGaQtmaQtpCQttuQ27aQ29uQ2/+a3fKa7v+fZgC2ZgC2Zjq2tma2ttu225C22/+2//+9u+a925C9/7a9///bkDrbtmbbtpDb25Db27bb/7bb///ep9LezeTe/7bfU2v/tmb/tpD/25D/263/27b/3e7/7vL//7b//8b//9v//97///f///8uDpbUAAAACXBIWXMAAAsSAAALEgHS3X78AAATWUlEQVR4nO2diZ/jNhXHPQu7DKcod1pgWYb7Bk9paSkN1ywUKBBgyjFA0wJD8RBKp6H687Hu23Z86mXf77ObxJasePT1e3qSJaegKFAqlj4B1GFCYMCEwIAJgQETAgMmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGDKG9j+ojit327P71xR+vrTRXHynEm8PS+YPnWdSK/3vMDS/6QK2F/Es8V0e37vmr3vVuJdftn9q1H/vh7KG9huVbA65vVdf2Y61YmyDot71/F0tedkYwMLs0WVAFaIrQWVN7Bt8WyxFsBqY/v0db2jrn4pQWFXv8bT6z0Prun+JUWUAwuz0d1TRXF3w1J/sSru1va4f6E4+V4AjFsnf11UWQOr6/CPq1NRW6Lm9i88r1MlsJXgEabLut5fnGwMsFgxwnJqlML05AcEdrh2q1Puxlht3RRnXqr0UtLjhek30u9dFmvl0GLZ+BcJEz2jr9Scdqs7m9oG4y6xzZVOrqyBbWt/yP43AivuXg0Dtn/1Zx8vGDCO/t41Py7eht395QR/5WHKGZh2UpbLe/i8bvWVn2M8Yul8z0sP/n4uMjgu0cr2+vndP/yDWxi35SSwO1evn0fNc17lDEwGdKmgQlK4FDwSQcerK1VAKujYFg/oKysLWMIlighzPWcFxJQzsC2/oCUQerOy7I0lGz8XT1fA61KssD7IdiML0cC8oEMUIXJvCww60mLOjrJKOnU7xh6wu6qb5afLjvMnVg+ssD7MVsf9J8/VLaUGxsP6757HgMmO/JLKGFhSu/vNvVcv/fWn436srZg8BRDY7Xc2g9IPy5abAAJ7tIXAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIAJgQETAgMmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTEOAFagpNCGwAceiUkJgwJQzMCL/oyzlDKymhbx8ZQ0MeYXKFpjwh4QgNVd5ApO02Csh2JTZyhMYp0XkJ4VuQHFHpDyAhUCIYkaIwYfMcgHmxIOCkvCHeoM1Z8iLZgPMMR7TbBFKTfhBVARy5OBun9xQunviSqyv9h+GlAkwp8dFgk/KNRJCj7Fv5o4Q3jx7JoBt2brpS49YHsCk4yMai9nv5ztGXtSurP3DXz1zzYBxS6P7i3WQuaWsIefRQcb9WcxSeY8y/HCB7e5fX64ZsJvoo+GWB+YG8I0odBt2XMxcYNszenPKgUUfIZEBMM1LWliXA46rJbPbMP7cljtXNbD4cycyAKYNJvSHcSrHxssRx3S5BtCGpdISBxzrKOOW8bk5zTxKTKkJ5HF2pPc/YQ9Mun3yxcz7YQk1Ijm22KObIAN7JIer8gbWJKLuvRxraxYXXGDU7m9P/lXZCDQwLmljoKFV3bMuDKylprt1osEbWWURE4/MXCeH65e2sOaabqegx/G7nlWOcoAxULvHN6mO2NLA2iL3jiKQ3WJFLafIge0fblJDHUsDG2phJh+B2i+rrFdlYfevU8P14NswJ7c1CwSOPGC8Dbt3nRquHwxMPz2+x7HjSs3bARaBVEpiU7jEi3VquH4oMOVhI+Y7MzB1p0zNi4PpHwWwhuH6ocBuv33lvB9y7OiyOtJgZ39wYDWqqaLEaS3s8Bq3w3yQ41aT98PkDzBM04b1r2ptZjDtLK2lw/pm9a5rokN906AdhyYA1nE1bhcNrWfToB2NRgjr12zeSKSPtzwwM/8UaMgY0RhBx+U6+tMy2axxNpP1j0AjhPX7h5tMwvomZc2r7J51sEuszevmjM3z6XHsjMp7oNEBtuVhvexBB9H98KDjkgcYkWGv5dswt6CMvaINjHWUb8/XFjCn/3ykYX28tGyNzAImON3w0V+x6Y5QLQmsvf5Grd3WpRbLqFQSm6JtkWNTNFwUsaiFtTqpMavWHqzKTZaFbTkwdgdT3QZxw4NlXWJb3Y1dt7mOCFvAQgtze0x5W9jIkjO882vKvDbs3xtxy5mCa8MmUJa9aDtK3N67vj0vgEaJUykzXq7qftid3xdnk/XDBh/rjBKzDbNjoorNuxfdrKWB8UH9QjIqFC51KPEze3j7CfRipYWBcTilZCT/SXzsnTiAFE2Ro5leG1cE1u9YTqsUKAq5IWhwekSZm97loTWJhrT87savhzh5QGhRYKyKVT+f13gpAiaNhXiA9Ittbg49BbBTkAqQ16LAmEVRyagUztGM0xS23SgYPCe1XaJvbuqf7xJVI2nvy2TyALFe1ViinItz+EyZqYFFRCUTSi2UElBJ/XtHVqJu/MxXR7iaQ7OZPOCErAoYf9sePBdtYpfIzasqKyoNrdRMrA2rmg1UnTNiSl5Lpn2mYcfyqLHFDGQ7ZweY3LC1IDBZ+VVVM7MYVbQq1Ab7O0plWz6t0NyoZUQldVq3wn412fQ41RhThvrLum7ytDBVPSVfGlW/Vppe/ZkWlaRDLC8ZNz9/wwBznWUYXLJEPUOnS5AynWIWJtdEBHkXAabCAu4Ma1hsJUAl6LEdKnRUFkapgyVs9Gx6+loIGJi4wwpk6r4eB0YWBJZqw25ONmHmhYDxvnLNiC/bYKT4BqPHVnMUbJ9xiXbwyNVoblTnbz55Y2Q1LbKgS4xHiextu3SUaKIB3leu5KqoUqxBLPXCG6cNoxYTuVaxwdyUxXWYiGSNiuURezAVhQVsf3Hw1KZRgfF+l1BZX9NlReSqKGeBlC0fkGjijCmJokILo64ndVOcMxShx0yDwREzNn1KeUY7MadJRomrs+CAlq8YcnrhjlKEATKgcGuoch5+IKyPAbKcoWrjHAX+0faezcBkRRHuGYnZMUzJMiKRjds/NB2PhtJbvrzrWXY6tigLNaRR+Ve0S4JHIeJFxPxWHo9r6WGImJ/rQP08chRMxfetf1aR2rBKix+pacQ69HbHo+nrW86u5ey7H1uoUUPGrBIWZmIIdyl9IcytqogMR/hebl3KeWoLDGRgtMST9omyuIMUpEN072QJBlXkMKbt5ZxPtkW5dx6cFMdNNtXqocndj2WnwQJBFm7wIIOwdkyksbpzWrFC4SCaowPLMT9HHYLJEJgY9ig4scIy/Oh4pHFf1AYWmIqTouvfNiLXllzzSxvqYGAdF6Vzu9KDG5Raji4yXFFJOsQYVKXhqOg/1qCZ0iofUDSeNAeUhVzS7lSu9/dwSFbNJwYrC1P//jBmYdlV2rtaBVA/W/AHu1XXnHzAktlCRu2KGe9qCUWASXNTV7v0fvoBCda28Y/yTfpPh4n9Pe64idktQw9TV841T1M2EPg2laEwKYHFtdWq27V3DhgKrPuidFWR+lPlpsSOjAGrfGn/WJkyK8eEne9ptDhC9bBHkbCO0PEl4gQrJdGmtci6cCJ1kzymWV0tTNYIH8+QwLo/w8yCE6a5/tFym83AqO0v1auc7eFc3PasEx+geo0zSKd0lDPhRe1rOaS10M6L0kvttcynbopx0mm2+XlG2DbYEQJjEgP42re5l7ntIudQaLuDgXU61gz0Sh/mPRGrUY1oq8BHdrddv4vN5c/2iDYk8ym4NiYAFi5KFyGi465sD9fShjUBizrKA5xt3Aid2R6xUG1BjQMscmfUPrbQXpDGTKsZWKrxSsr7Asf/+uUEXy12zDj93glYY2fkaXCUeC7NKWzEzLE6kmcbIYD2KPEQOeGJ02eL2J4T2etPA5/Hkq7zSMrcwGpiNaoWCxMNWFJjA7M+6wER1XDGz8Otr5bZHpG+XUOGthS3Sxh2Hn2N4BJvz+/9LR9gNhM/fowHOmag0aquhrWafYHF7iJEhzqnBsaGpyJRvXWsuP0/j+wQxQJmRZNeJia/h9a4kiwBrPRu7sS8XGl9lT/GSWcE1nbswXFDf9lGFBkSodQfE+EKgHEFj/AzRuFv0GjNO6WbPDTCKDLqEuc2Tz9sPlnXhneJaJfojolwWe7J1CqhpRd6OD02r7+dAubUf3w8zCFO7TIiWgaY2zyMG3Qo+W7PBB1V4DipNWzsDAu7kwd8YBajuPxswWH2CaaB2dkWsjDie5r4kSMCC8aMPUOsqkjNk1IwCyzQCyDSWHoBc4jTPIDZG5MAa283ZTxpmrZEZRN9rzVuAyksCYtrbqKU/NK0jtfCWmX7R9sePWAswJfzhRKOL2j9qCnJDTLM7jb5xHXC8bZhbZJ3P52mTZ2O6xVLRqx+dY2KUtfCIhoAzJwKzcLCMpAb8KfGy4SRlXph0hjAuguBeWoY17eA1aYljKw2+YOADVbgEBFYkphiompM/4DjzNO6/UshB2ALBR1db6KW4kxKwseq5p6Gj8AsdRsyU7ZmHu8xJzQENkjL/3IBAjtE8k7Zkg8fQGBMVeRTShM/fKDtBHIAtrhMO9beohkj63E5RedVurFq2xkgMGp1x7pOlmz+sauGOV6xXfa6gfYZX/MDy+/Jd94MvPbsRE0hoCRmM2lgQelmklBwLgktYGHBtbl0G6bntXYK82XlingxZhBJI4nAsCYwmFNpPIM5gREat6+FgR04YVhkk52yesM/x7SNWDQq5xIxc5bbr5lZLUy11ZlZmFQ3YNboiDIynaCpuyvXlL9175r6E0vSkycdzesS4zaWB7AO41TGKNgHwv6TilRygrKscz3hx8wFcorQE0sCquGtuYgWsLBAmQAL58BVfo5gw3TKKit6qKgVR0SwGDoRYPoGXZzaEm1Y3jLW4bcl/hxVe46wCR0cU6EhFlo5xqi/1b0150/E05o5SsyfmbEO/yKPmQoTGxDm6+eVl3Nm+ZiAQm/4v7UdPYsq0ZTNHdZn/9xWz2mZaNsJ8qwKZ20Yixf1EvrKFGXFEQf0jUN/aWkwsEN/2j7CK482TKjyJfca66C6yk1QR0hsXrc9Z9Vp01qJKQcbaUuHAjv0h7djFpYTMKVgDpzca22bDREv+iOMbnShLaZLNGrFmtRrSwevDzvsp+3bVxc4Ry4NzA+0fVomnXXHvBHGwFjdNu3Qk5CazcIa7iFlCMymVZlAO4LAgiGfzDLaeTsXhtIIC/o6tmHpe0g5AoswaTtGjeKMFlcFTSnTfFFiJk+wPlhOa9YiyWzEzkvwtRMAi/+0/ZK31Yco6pcaRdRSwHG+fmxgdVh/AuGHt/vKjT06aNTJVeHXjhF07C/OBgHLsA3TCvtkHRS9JzHg6+0944T1l6fHCqy/JprBOFJYv337wT86YXSUwKaawThCWM8f/Bx5xPojDWyyGYw5zJo6RmBMk8xgzAHYkarpWR/9hcAmFaFjN2UIbHqNamQ5ADvWNkyK9J/aHRECm1o6XhznZ20R2BySQ/hjRCAIbAaZGy/DR6wQ2DzSQ8JDjSwHYI+KZIw/zMgQ2Kwafu8Fgc0uIu2sH7McgD0KbZiRmt7dc5QRgS2hAfOrENgCUi1ZH2YIbCGRnnPiENiC0jfMDvg7cwD2qErPYjwkZERgi8qEjF0NDYEtLmeUsZVZDsAe2TaMy4wydrIzBJaD1ChjdF2gKwSWiYhuzJojfQSWlcx0xtTfjsCyE9GtWUw5AEPZapnOiMBylLltFgiB5aqEkeUADNuwiFJrzBBYzooY2RhLZg96Ek5ECCwh2Zd26mGkBX2dn4QTEwKLS9/ntKthKLDIk3DiTxFoEAJLSo3mG+VgYahmjWph3Z+Eg+qpcduwiY5FpYTAgAmBAdOUwFBTaDpgnUsIshT2h6GnMPhPAFUAAgNWAAIDVgACA1YAAgNWAAIDVgACA1YAdn6BCYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBAdNAYLfnRTj9zdEbX3nZenNT/rIq3vZR8thfWwtJik/Caz+J9OHih4B6F7Bb8elkfQvYPWEO7ljGMGCsvranTTn+Sx572by5Ke/9xuatH3xw89p7vtVSSFrbYt3hJJK6XLP5lv0LuH1yQ7f9C7hhtOXBXcsYBoxNB96FP8pi9Of3/4aZlnzzUr74LvrG1363fvNz328uJK3dJ59at59EUnI2c/8Cdvev2dE9C7g8ebE+SB7ctYxhwPgJ11dZg5pc4sv0ja9+c/OfD/+orZCE9g9/XV+XHU4iod39nzKX2L8AaWG9C2CE5MFdyxgGjM3fHgTsf1/4EP3n+/oC254xR9LhJBLarTju/gXIhqd3AQyYPLhrGcta2O35Z75Mvv6RnsDqb98PtLCDLu5IAY9v6M2dKzgW1sHxNkeJbKHFm5/9cb8mZMun8Z0NaMOe4ZXUvwBpFr0L2M3dhrHfWmwJbRqAfelj67d++Fv62rtbC2k4gXWXk0jpci3MtG8B0sJ6F8AIyYO7lrFkP+zz7yyKdxDygX8t1g+rjxzSjWKB+aCO3Oz9MNTsQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIAJgQETAgMmBAZMRw9s//DnRXF2U/9f+kzG0fEDuzilu9Vp3/Ux2en4gT3c8P89VztkJwQGTAgMmBAYMCEwYDp6YMcmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkz/B4wwVyb2cFPgAAAAAElFTkSuQmCC" alt="AIC and BIC based on Vaal River Data"  />
<p class="caption">AIC and BIC based on Vaal River Data</p>
</div>
From Figure \ref{fig:Vaal-River-data-AIC-BIC-plot} we see that the gamma change-point method gives the same optimal degree $m=$ 19 as the exponential method; BIC and QHC give the same degree $m=$ 11; the degree $m=$ 16 selected by AIC method is closer to the one selected by change-point methods. From this Figure we also see that unlike the LR plot the information criteria do not have clear peak points.
<p>For any given degree \(m\), one can fit the data by specifying \texttt{M=m} in \texttt{mable()} to obtain an estimate of \(f\).</p>
<p>The \texttt{summary} method \texttt{summary.mable} prints and returns invisibly the summarized results.</p>
<pre><code class="language-r">summary(vaal)
</code></pre>
<pre><code>## Call: mable() for raw data
## Obj Class: mable 
## Input Data: Vaal.Flow$Flow 
## Dimension of data: 1 
## Optimal degree m: 19 
## P-value of Change-point: 1.339692e-08 
## Maximum loglikelihood: 56.81939 
## MABLE of p: can be retrieved using name 'p' 
## Note: the optimal model degrees are selected by the method of change-point.
</code></pre>
<p>The mixing proportions, the coefficients of the Bernstein polynomials, \(p\) can be obtained as either \texttt{p&lt;-vaal$p}</p>
<pre><code class="language-r">p&lt;-vaal$p
p
</code></pre>
<pre><code>##  [1] 6.663951e-142  1.049278e-01  7.594313e-01  2.309036e-08  2.508441e-16
##  [6]  7.194500e-21  1.715117e-20  1.049294e-07  1.202354e-01  1.097612e-22
## [11]  3.689746e-96 2.261501e-228  0.000000e+00  0.000000e+00  0.000000e+00
## [16] 5.038909e-234  1.226874e-39  1.540542e-02 4.735457e-197  0.000000e+00
</code></pre>
<p>or \texttt{summary(res)$p}.</p>
<p>The method of change-point for choosing model degree is computer-intensive especially for multimodal density. A better lower bound for model degree is $$m_b=\frac{\mu(1-\mu)-\sigma^2}{\sigma^2-\sum_{i=1}^k\lambda_i(\mu_i-\mu)^2}-2,$$
where \(\lambda_i\) and \(\mu_i\) are, respectively, the mixing proportion and mean value of teh \(i\)th component density. Less computer-intensive methods such as the method of moment and the method of mode implemented by \texttt{optimal()} can be used (see Figure \ref{fig:old-faithful-amrginal-data-plot}).</p>
<h3 id="example-the-old-faithful-data-label-old-faithful-data-mme">Example: The Old Faithful data \label{old-faithful-data-mme}</h3>
<pre><code class="language-r">x&lt;-faithful 
x1&lt;-faithful[,1] 
x2&lt;-faithful[,2] 
a&lt;-c(0, 40); b&lt;-c(7, 110)
mu&lt;-(apply(x,2,mean)-a)/(b-a) 
s2&lt;-apply(x,2,var)/(b-a)^2                                                                                                  
# mixing proportions
lambda&lt;-c(mean(x1&lt;3),mean(x2&lt;65))                                                                  # guess component mean
mu1&lt;-(c(mean(x1[x1&lt;3]), mean(x2[x2&lt;65]))-a)/(b-a)
mu2&lt;-(c(mean(x1[x1&gt;=3]), mean(x2[x2&gt;=65]))-a)/(b-a) 
# estimate lower bound for m 
mb&lt;-ceiling((mu*(1-mu)-s2)/(s2-lambda*(1-lambda)*(mu1-mu2)^2)-2)
</code></pre>
<pre><code class="language-r">m1&lt;-optimable(x1, interval=c(a[1],b[1]), nmod=2, modes=c(2,4.5))$m
m2&lt;-optimable(x2, interval=c(a[2],b[2]), nmod=2, modes=c(52.5,80))$m
erupt1&lt;-mable(x1, M=mb[1], interval=c(a[1],b[1]))
erupt2&lt;-mable(x1, M=m1, interval=c(a[1],b[1]))
wait1&lt;-mable(x2, M=mb[2],interval=c(a[2],b[2]))
wait2&lt;-mable(x2, M=m2,interval=c(a[2],b[2]))
</code></pre>
<p>For this data set, we obtain lower bounds for the marginal densities \(m_b=(78, 28)\) and \(\hat m=(122, 34)\).</p>
<pre><code class="language-r">op&lt;-par(mfrow=c(1,2), cex=0.8)
hist(x1, probability = TRUE, col=&quot;grey&quot;, border=&quot;white&quot;, main=&quot;&quot;, xlab=&quot;Eruptions&quot;, 
     ylim=c(0,.65), las=1) 
plot(erupt1, add=TRUE,&quot;density&quot;)
plot(erupt2, add=TRUE,&quot;density&quot;,lty=2,col=2)
legend(&quot;topleft&quot;, lty=c(1,2),col=1:2, bty=&quot;n&quot;, cex=.7,  
       c(expression(paste(&quot;m = &quot;, m[b])),expression(paste(&quot;m = &quot;, hat(m))))) 
hist(x2, probability = TRUE, col=&quot;grey&quot;, border=&quot;white&quot;, main=&quot;&quot;, xlab=&quot;Waiting&quot;, las=1)
plot(wait1, add=TRUE,&quot;density&quot;)
plot(wait2, add=TRUE,&quot;density&quot;,lty=2,col=2) 
legend(&quot;topleft&quot;, lty=c(1,2),col=1:2, bty=&quot;n&quot;, cex=.7,  
       c(expression(paste(&quot;m = &quot;, m[b])),expression(paste(&quot;m = &quot;, hat(m))))) 
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="The Old Faithful data"  />
<p class="caption">The Old Faithful data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<h2 id="grouped-data">Grouped Data</h2>
<p>With a grouped dataset, a frequency table of data from a continuous population, one can estimate the density from histogram using \texttt{mable.group()} with an optimal degree \(m\) chosen from \texttt{M[1]:M[2]} or with a given degree \(m\) using \texttt{M=m} [@Guan-2017-jns].</p>
<h3 id="example-the-chicken-embryo-data">Example: The Chicken Embryo Data</h3>
<p>Consider the chicken embryo data contain the number of hatched eggs on each day during the 21 days of incubation period. The times of hatching ($n=43$) are treated as grouped by intervals with equal width of one day. The data were studied first by @Jassim-et-al-1996. @Kuurman-et-al-2003 and @Lin-and-He-2006-bka also analyzed the data using the minimum Hellinger distance estimator, in addition to other methods assuming some parametric mixture models including Weibull model.</p>
<pre><code class="language-r">data(chicken.embryo)
head(chicken.embryo, 2)
</code></pre>
<pre><code>## $day
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21
## 
## $nT
##  [1]  6  5 11  2  2  3  0  0  0  0  1  0  0  0  1  0  1  5  1  4  1
</code></pre>
<pre><code class="language-r">a &lt;- 0
b &lt;- 21
day &lt;- chicken.embryo$day
nT &lt;- chicken.embryo$nT
</code></pre>
<pre><code class="language-r">embryo&lt;-mable.group(x = nT, breaks = a:b, M=c(2,100), interval = c(a, b), IC = &quot;aic&quot;,
    controls = mable.ctrl(sig.level = 1e-6,  maxit = 2000, eps = 1.0e-7))
</code></pre>
<pre><code class="language-r">Day &lt;- rep(day,nT)
op &lt;- par(mfrow = c(1,2), lwd = 2)
layout(rbind(c(1, 2), c(3, 3)))
plot(embryo, which = &quot;likelihood&quot;)
plot(embryo, which = &quot;change-point&quot;)
fk &lt;- density(x = rep((0:20)+.5, nT), bw = &quot;sj&quot;, n = 101, from = a, to = b)
hist(Day, breaks = seq(a,b,  length = 12), freq = FALSE, col = &quot;grey&quot;, border = &quot;white&quot;, 
     main = &quot;Histogram and Density Estimates&quot;)
plot(embryo, which = &quot;density&quot;, cex = 0.7, add = TRUE)
lines(fk, lty = 2, col = 2)
legend(&quot;top&quot;, lty = c(1:2), c(&quot;MABLE&quot;, &quot;Kernel&quot;), bty = &quot;n&quot;, col = c(1:2))
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAH4CAMAAAAcm0gZAAAA/1BMVEUAAAAAACoAADIAADoAAGYADToAOjoAOmYAOpAAZrY6AAA6ACg6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLw6kNtRDShRMWZmAABmADpmAGZmOgBmOjpmOmZmOpBmZgBmZjpmZmZmZrZmkJBmkLZmkNtmtttmtv+B//+QOgCQOjqQOmaQZgCQZjqQZpCQkLaQttuQ29uQ2/+c//+2ZgC2Zjq2Zma2kDq2kGa2kJC2tma225C22/+2/7a2/9u2//++vr7bkDrbkGbbtmbbtpDb25Db2//b/7bb/9vb///fU2v/tlj/tmb/25D/27b//53//7b//7z//9v////31w0nAAAACXBIWXMAAAsSAAALEgHS3X78AAAZmklEQVR4nO2dC4PbNnLH0e72vFLzcs5Vu7FTJ2mTU9dxL8lWbnpN0l3ZuTq7la6q+P0/S4kHxRcI4jEAMdT8zxet+BjM4Cc8CZKsIKESm9oBkpsIGDIRMGQiYMhEwJCJgCETAUMmAoZMBAyZCBgyETBkImDIRMCQiYAhEwFDJgKGTAQMmQgYMhEwZCJgyAQP7HC96G/csXX5b79cjWxraHN5B+6bi1Qc+yVj7OKb5p4f2cVt+XF8w9jvvi8GA+iaa9kpI6/+/PVrF7fSASuKogest62hbICV/r0RhE47rh7Kj+PN1c/HHy9urYEtiuOmaaedjq3iAdu/YE9K97bsyUeXd3Vp4j7LXdW2T5b8h6cOr8/6IiNgqjwI5443jHHXqjJSBfB2yQvQfvnpC/5Nhl2FU5njxk7By0O5OfEDsFQ0YOXHw1b8/g7XDWDbMszy47ipt139dnN5pw5vnwXum0ccApgsGScfRQZvVWlRAew/uOWVQvVNBqAiPZkTm4WRVuQubkUDxuPhgC5EHBUcxp7JXXJDVeou7xqH12eB++YRh2jDyqaqDkkBq/xTARTHP33OZAWpwlEfqiRWVaIyUkeeE7DyT/6xbQIrQ9syrlUPmDq8PgvcN484GoVdOdcrYStZtJ58v2kBKwNQkUpzvNPxh8pInsD6JezqXem+ChVLCVuVnjZDUsDqNqxZpvolTBzKrt4rLtmWsP1S24ZVQclqvLlNHZ5jG3a8ERmvnGv1EutfHFv/5fpUwuo2rPp5nvpiy7oNywWYrAZa/b0ajvjFlh2qdbuE5dhLFHGoXqKEJ5xTwIrjv57GYWUAZW/v4ss6HBWAjFSaU1wavcTqUJdIY8907Njq+Nql2zoPxQs7+tTUG1aNRM5K0cKmuURkImDIRMCQiYAhEwFDJgKGTAQMmQgYMhEwZCJgyETAkImAIRMBQyYChkwEDJkIGDK5A2M5CTIncpLBTdRxARKbOpCOhv10DywoX2AFCgzMVLg8gR1ePhyuu0t6sAQ2oalw+QN7c8v/a2krnapqw9OZnTh93dpmNGWspCIoCNjx21YRywBYXc/7OXN8JZaFfmgf10i7Ai5fYNeLt5mVsE7D7OeMjMj+hzjaEQCXd6djxxaHz9rL6yYDputJeQL7zK2EIQLmZiuehrq9adowPMCcG+cIMg5SYJwZHfpUxTlZ7J7A3BtncBlg+TvjOVzJH5hr4wwtI6sAZzyHKwiAdRrnlFX5KCt1lI9tt+HKKfn8gU3Uho0XrEBn3IYrDRcS/lyHdwHaCpWxfwHqjMtwpQMsCTIEwHSwbJoVQAcMnnWdBEvV1ZmxmQ7h3aVdXe8tPSurZBJP/jp6F8UZY8r7p/2bPlNcgnKwAOiMzd5EyLyrxO26tynU00FKPpmQHFiRZt4jkzYMlFWoM26mWnvnD8xIKiT2aYDF798HAOuMVhzzKBopH2d8TFVOJp5BnQhYHEiezviZGgYWtZBNUiXGhuXkjK+pswXmmgq0M76mzgZYbFJOzgCYmjWw+AXLwZkpTIUrIbCEtMadmchUuAhYDFPTtM2wwNLi8gYGc51vPsBcTfrLLy2gtSr4gaXG5QvMeq2KORwC5i5PYLYLSVOH00h4eBekreQBRm7D6njMw2pwJQGWsrMx6sy4NjWvQc/nDyyjWW2DPJY+EDAYeSa3XbRKmIUpAgYj3+R2CxBg0ZClm+lAAqzYXb0+b2DDlyGiyj+5/ZKAjaQUQ1HnEpswCBiMJgdWxGGWDlhixQKmOlBW5icAph2XcOVwB6ZRZwpMToT21kfZz2rnOOcWYMrtCtEkwA7P78T/2wKa1Y6oHIDFCH+8Ddv1qr4C+ax2gCkMwPRyn9VOLAIWZCu9onbrHU6FRuZZJbraGt0LrmTARhJKDmyg02F3GcJygBlDBKwtuzswCVh6YENVYvsOzIG2mICBK26ng4CBKyKwTpHLJzBYU+MJgdaKEXuJKIG5z5HmBsy3l9hr1FAA81j5iwPYeC8RJzCPp9TlBsyul9i3Ndmc1Cl9n7NcHyFr7QxYZkTrdOAEFuk6X/7ApsYFVQO3xpf+QSUFtul1LpRMj31AC2zHrl6zC/3j93AA03Q4lOYIrOxubK8eBh5wOX1QhU0J+/chYCZb08fm3UvcrYZ6iSFBgWXICLDBRTiOttIrZBwW4Y0XqYBB2RrdCy7P5HiP3u2NF3YJJSthL99fA5UwHMDcTeUFDMrW6F5wZQasgGKWrg0jYCmAQdka3QsuAhZka3QvuM4X2I4turckutsa3Quu/IDBILOY6fjp2fBsh9aW3i8CRsBsnIluKjdgHksEpp+XKhICczKUApi7LQIWUel6iYmVJ7Dw3/J4G/ZPZa14NpO/8U1FB8bbsEWwrfQ6X2CGS5j2ttLrTIGd2/Ww2KaKYGZ0eaWtGCt/u8fHBDYkj/cdowAWZeVv9/ioJWygSvR43zEKYFFW/naPD0LmX8Ic3ndssRdcnsDcV/66JzQJMKf3HVvsBVe2bVhsYKpS7M0murzv2GIvuGCSY+MVWG7A5KOL3tuMxeYAbMd/m9Gr+gBkFpdX+O1Gv5wJMN5L3KxRA5OXVzar9j6wp09HU0Av8c0PKYB55ofvbH3kF2+HK2Acdnz1iQMwH00AzO6xDxPK0xnRowe/oa+viMCgHl2UWNnOJVY2PX/hlp0OmvyFv45OwFrCAcxnEDe8S37oH3Dp3ktMrPMFptdwLzGTzkf+wPxMWgHrDCSFBh/7MOQFinGYh6mgaaaEwAZtETAn0+5XZ4Z3nf4iYLESSgrM9BQBt5Ri6EyBmRbhELDwhNzHz95TU262RveCCwewwrmQEbBQUxDAHGwQsFBTBAxGaIA5VorpgCVW5rP1bfsOyAhYW9O8F42A+TrjsfIXQgTM1xmPlb8QchiOEbCWIj3z10IEDFMbVtj3PAjYiJVUi4vyA0bjsNFkbJARsJamXCBLwHzkvkAWtCiPIyNgHY298QIsIa2p8TaTgIWaAo1rHBkBCzUVB9igVQIWago6LgIW2RR8XFGApbgXOEiIgRnH657AJprVdhCi62EDiYICm2hW20EErKXpZrVtNQdguoTTtWGJhR3YUBmj2fqkptyS1SELKGGOz7NILALWksfzLBILPzB97z6klxj/eRYBQj0OO5kGA9Z9noXFlVkC5pd2J1992zD351kQML+0O8hoLjHUVOy4OtP3BCzUVDJgMiHfTsdMHw7mYSp+XBDABtc+DHc9cADL9CpEjcy7ShxY+4AcWIKnansqGJjWJnpg3asQOQ1XUgNLLE9gGV+FCAbm+BSBxErWhiUWAUtqKlx0eSWpqXDBAstKQfmCMS4Chiwu94iHOvT6veajo2z2FJK4CJhdItnERcDsEskmLgJml0g2cREwu0SyiYuA2SWSTVw5DRdJFiJgyETAkImAIRMBQyYChkwEDJkIGDK5Atuwi9veRvHqsQ37qw/Fh7r2frxh7Oqhf4I8QGNnu9JsLo8ut/Q2bxlbDDjjJzRxOQLbXT2U/7ob+VrT3dU7dvFvxW5RvTlux1Ne906QB2js7Niqb16uSNMZ0dn2F564HIGVv5bem/yO3/EVY9u/++5///Zf+PfGAdu17oRyQ3/z/um7Vd/84fNl+ZPrbd5+xXSb/YUnLldgvTsyRWg8sHXxf3/PA9uw0+ugyx+M5gR+QG8z/3VqNu8uueXe5s2i0G32F564AEqYCmxVqF+iqLRPyetO2K76vy1+Xby/mWunOXqt3ewvPHFBtGEisHLz//xNWdevqsCON2vdCfIAnZ2dpq4XR2sbDN1mf+GJC6SXKArwhv31P8je1EIdyX9b2v6RviO0G+hN6TZv9Zv9hSYuGochEwFDJgKGTAQMmQgYMhEwZCJgyETAkImAIRMBQyYChkwEDJkIGDIRMGQiYMhEwJCJgCETAUMmAoZMEwDbf3rNVhsGtHwmH6WJawpgH94drtfFpv/wTNxKE9cUwJ6J5UjzA5YkLgIGJgKGTLMFRgoRAUMmAoZMBAyZCBgyETBkImDIRMCQiYAhEwFDJgKGTAQMmQgYMhEwZCJgyETAkImAIRMBQyYChkwEDJkIGDIRMGQiYMhEwJCJgCETAUMmAoZMBAyZCBgyETBkImDIRMCQiYAhEwFDJgKGTAQMmfIAtl/yt/1c3O7Y6Y7uX78OsLe5vBNWGWNPftYfwpNqpiEOrt9RU+5qONNQkF8AygtYveVwvQiwVwFbFceby8E3jLXSEC6MJx/mF4DyAsZ/1G+X7GIt3wy6f8Ge3PJ3ND356PLucP275eXPfO835Y//0xfs9/+xLP/kkhv3y09f8A3l4V+cgIlyIu1U+0UC5fY/lGk8eXH1cLheFTWwOvl3bN1MRyTS8ksaSqzsgO2Xz3gB4b/k8v8P5cZy5+Gabykp7D+45Xt3Za5t2eJBlSS5cb+8+u2Gf4jDK6vlf8p/x+b+Z9LEmqexFX8VJ2CN5Hcc2CkdlQjfcbL3TBXllMoFGBMtiAB28ey/ZdXD68gyc/iHyqqiOP7pc3HcShQdVYvKjTzLy+PU4YViUJ7GtwjLK8lVJKCA7Zfrbd3glYWnTl4Aq9ORiVR+1Z4mVi7A6irxxzLjfv9QZYzK760Ctl8++X7TBaY2NoBtWyVMvIeSrdR+lYACdrxZbBYnF0rVybeBqUSEX9KeOjRxVuUHrDj++kJVV/0Spv5uA1Mb9SWMFyFZDitgMgEFrDz5o9XJBa5T8m1gDS9OvSNxaOKsyg4Yz6O3VXXVbsN49rL1X667JUxtPFV5zTbsqEhuT/tVAhWwHatxFvI12W+1wGQiqg2TzopDE2dVdsCKd6LLV1Ioc/rUS/xCASt7aRdfttuW08aqBDV6iWocthPduWr/O9XRXIs0DtfyiZSyGW0m/5+tdFQi4hxprzo0rfIAZlSZa8fX0Z7zOfnAylEIgBVvmChoUVQWx9Qd8zBhAEZqiIAhEwFDJgKGTAQMmQgYMhEwZCJgyETAkMkIbMfk/BopH5mAHV+Jq00f4pq7mblMwA4v+Ywrfz0FKRsZgX1GJSw7URuGTNRLRKaxEramNiwvjfUSN2sClpVGe4lvfiBgOWl0HHZ89UkFjEmlcIs0JGP2ix59t1tPwCaVe/YTsEk1nv3dTgcBm1RUwpApLrB7g5wTJnG5T00RsEnlfnmFgE0q98sr2IDJ21J2/LYJOUxZipu79k8fivoWCDxyv7ySJzDWU7Vn/8k/lgG8+biMZfMVv2GsJFXWHQrY09Q35IVqJm1Yn1cN7OmP62L/dVm9H16+f34ngf3xYZbAgs/Iokp8+udnxdsfSmDbNf8nasHLu0aVmPzG8hCdA7Dfvv2vP/726vZwLW8756Q2ayphOuUB7GH7z9+UrdaO37mnSBEwvTIBtv/g9vjqBzFI2V39mdeCC1kZLmQvcTVqJB/NH9jMRMCQKQKwRpeagIELHFhrFETAwAUMTLCqiREwcMECq0BVxHIAJrvx+odxHJ5jGjMLgQJrtF4SWTpgj0r19+ovDmwzML1LwJp/pwT22AH22AImeG34eGv78eVPHy/Z1YP8eubA2kvg+Lc8qsTXfP6az3Ns19sFB6imPbbr8wbWXbJYfs8C2FIsXhYPOVxtV8X+WVG8uZVfZwbs8PLhcN2byzYA620wEfP32U28DSsj2Yn5pxMw+XV+wN7cquvO42do1gQbiQU47STRS9xdPWz4pb0TsEJ8nSUw2yUCujXcOQCbmYzArhdvrUuYds29qYh5u3zeMnc6dmwhF3aMn6EFdk/AoAXWSxwCNkjMOWESFxQw/V1I9wZizgmTuMxtmJjGvbTpdAwBG64UvV0+b5nvD9OteNCeMXCb372hiHk4SxqrEretSVPDHZjDwAaJ+Xp85gJqwwzAhipF54RJXAQMmWDuwBy6U/3eUCd6OEuCKmFGYAPEnBMmcUUDJi4hCjLlXwQMTDB3r/SBPbaAPT4SMCDB3IHZA6Yu0Ss2WmJBbp+vQO7A1BUw8XGiQ8CgBHIHpqaAyc8THdYnFuL1GQukDesCe+wB0xSxEK/PWBC9xMEC1gDW79q7+0oqIgE76b5JjIBBKCEwRsAAlAxYr4g5J0ziSgesS8w5YRIXAUMmAGCGh8p2gLX69s4Jk7iAgdU3jQjdG4i5+0oqquw/XNs/H8sE7JGAxVaV2Rtm+y7y/i0P9d8dXt3bjVrEfD0+c9W5vV/aPYbOAKzLq3d/GGtM2/t6fOZqljC7d0AEAWMELFDhbVgNrMdLA6wm5unwuUsBe/lg/VKcEGD3BCxUIrc34jJKv9dhdXnlBKzPS3OPcz16BnH//FSXsL7slgiYXsZCwMDFc/vw8v217sGcVksEjC/P6QOriQE4f44KXiLgDowRsAAFLxFwBXZPwIKksnu72tg+lzMcGCNg/lKdjue/lP/z6dab3/+mA1Z17T0dPndVwH56+r4HzOYOzAqYpk9fDD1rShKD8f/spPJ7w9abfpVocQcmAUus0Dsw1Vc9r0FgnFiI12esUwmzfkFCOLB7Auavqg2zg1Wfcfomvg7wGnz8Hifm6fC5S2a/aeLXPNNBwBKrurwSVCUO5v4QMCLmrdBFOAQssQKnpkbemz4I7J5euO4plW87tug/edri8oo3MCLmqdNMx7N+T9Hi8goBSy0jsPHLKyHAiJiPTlWi7l2rEdswIuapsF7iWJ6bgPGTqavorEmBUd/eXSLHjzfaRVOGM6q/RwqJERgR8xHP/uMNb6Z2lsTggBUEzF1y1ZSu+2464/R3KDAi5qpQYOYMHwF2ZkWs9xJ3LyPF0FIA0xm1woCdETHWUoCdsDNGspuAKbUwBRELBmZEMgpM94odzBqIlSNqXmIPQBYGzMjLCtjoUA6XhnG1Vx1NBWwMiRWwOREbxtVZJuYd9uTA5kXMwKuz6sg37OmBzapS1PHqBSzlSSwLYPMh1sfF+gEr+cVtvN3I4h2YAMDmROwUXfWaYm3ASjGAjb4DEwKYIDaP8ViX1wgwD2LjwMzrEkGAzefSWCO+ZnUo0OkeqmDAOSAjMIt3YEIBmwmxFq/6S7+4RQFm8w5MGGBy3n4GxPS8amZdYMNdkiFl0EuUVmdB7IRE97qZol/Ghjv9gwpcSAoJDD2xUxliOl7a7IAFZvOcDihgM+h4nKq8wfdvxQZm85wOSGC4h2OntwMNv0NSB8z1sSVGYJ2FpLqLb3DAkI+fZX0+VB22s6PRloECi92Gdbf4dJqykXqd0yCuNrAametjS6bsJfY2eXSaMpOBVzPgRhcfHli8Nqy/zb1Kz0rD1WEv4EYPBRqY+QxYYLifRGXE1Qu4HgIgB8ZEMM5uTS/eaXIJuF3ErFMx7Uzc6aiQiV+fQ07lIdHJ9ckOScw6GcO+2APnIWAYianxzrTAYg+cB3ZUxFAgU15WY8iJgVk84DICMEGswEFMOllPJ0wLbJI2TBEr22/Dokfb6GKry8sn4MfH3qpFkzLrJSqZBzTZABO8WrN1HgGrF8nbppknsDFizk5HUcWrsckn4Een531mCuzePAp1djqGOK/uZLhXwI8uj4/MFphxnsfZ6RjijU/3AoNfwI8OTyPMF5ipWnR2OoZ0F/D8AnZ5fGTGwAQxpu0sOjsNL/19eX4B8x+mdbrungJ4aLtXrfTQ7J1YQ7dRegbcvnvMnLK7rxAeWu/VE3N2GlS6xkvJM+AZAdMTc3YaUHwKZnAxg2fAcwImH4bZQebsNJiEL8OZ5huw/XIWBMDkqzMfWWvvJBJ+GHARsDqgRzXlVu2dQLJyDnlswvC+2QGTc6TTLSDQrfDTyTdgIGBTzdbr96pMc5kpBRGzpVVMDWySK87mvQ55ByLZag33CrvyDtg6hQyvOJv3MmbxizdZHi2edTr9+ygjXp4Yc0ub/W1NdcXZuJdnHxuj1jy6d1/WWI7U6t/RlTewzNowKQmgnbE9cu2DG9lefTdQkmMIhxsaQPbCALM4I5L/pr3NPGc9PVatTqNTKXOkWcf1z2udPbg4IXNgOZYwoUYh6SAYIzIAqGVsipBAgGXYSzztrfTYyfKWVy02mpP1Z08Tki2x0F4iCUggwCxu6CMBCQKYvg0jTSoqL8jkfkMfaVJRCUMmAoZMgZ0Oy/EpSSN4YPqBs/XpwN5Mbi4P59wHzhCpojSXh3Pul1cgUkVpLg/nQtswv1RRmsvDuUAv8ggijbk8nCNgE1mbCBgptQgYMhEwZCJgyETAkImAIRMBQyYChkxBwDbs4nb8KAdzgPYOz+8AHVTWYMwdbxi7evB0LgTY7uqh/BdgoC15NQdIO/7eMzAHhTUw/3aLEv7a07kQYNuV/OUB6fD5ki2AbB2/41eFoByU1iD9K7ZrT+eCgK1BV+jsyl/xFmxNnQAG5iA3A+lfWcg8ncuohHHtVlCWIEtYfRUXyL/Nwjv3MmrDeGbAljA4B4U1KP+ON9zKBG1YhF4iWAGTZQLMQWUNxr8Nvyy8mqCXSJpABAyZCBgyETBkImDIRMCQiYAhEwFDJgKGTAQMmQgYMhEwZCJgyETAkImAIRMBQyYChkwzBrZfjtzvi1JzBvasuq9+Tpo5ML42acPYotis5Xf0mjuw3ar8OL66Lf8LtyJrSs0dWElpy5fEH7/9BXgJ5USaObDD87uyUuSr4rdfwS2hm1JzBiZ7ieXHxZfr2XQ/Zgysrf1TuDXKU+pcgG1B1yhPqHMBNhsRMGQiYMhEwJCJgCETAUMmAoZMBAyZCBgyETBkImDIRMCQiYAh0/8DvDDNmX0solEAAAAASUVORK5CYII=" alt="Chicken Embryo Data"  />
<p class="caption">Chicken Embryo Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<p>We see in Figure \ref{fig:chicken-embryo-data-AIC-BIC-plot} that AIC and gamma change-point method give the same optimal degree as the one, \(m=\) 13, given by the exponential change-point method. However, BIC fails in choosing a useful model degree.</p>
<pre><code class="language-r">M &lt;- embryo$M[1]:embryo$M[2]
aic &lt;- embryo$ic$AIC
bic &lt;- embryo$ic$BIC
res.gcp &lt;- optim.gcp(embryo) # choose m by gamma change-point model
lr &lt;- res.gcp$lr
plot(M, aic, cex = 0.7, col = 1, xlab = &quot;m&quot;, ylab = &quot;&quot;, ylim = c(ymin&lt;-min(aic,bic,lr),
    ymax&lt;-max(aic,bic,lr)), main = &quot;AIC, BIC, and LR&quot;)
points(M, bic, pch = 2, cex = 0.7, col = 2)
points(M[-1], lr, pch = 3, cex = 0.7, col = 4)
segments(which.max(aic)+M[1]-1-&gt;m1, ymin, m1, max(aic), lty = 2)
segments(which.max(bic)+M[1]-1-&gt;m2, ymin, m2, max(bic), lty = 2, col = 2)
segments(which.max(lr)+M[1]-&gt;m3, ymin, m3, max(lr), lty = 2, col = 4)
axis(1, c(m1,m2, m3),  as.character(c(m1,m2,m3)), col.axis = 4)
legend(&quot;right&quot;, pch = 1:3, c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;LR&quot;), bty = &quot;n&quot;, col = c(1,2,4))
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="AIC and BIC based on Chicken Embryo Data"  />
<p class="caption">AIC and BIC based on Chicken Embryo Data</p>
</div>
The results are summarized as follows.
<pre><code class="language-r">summary(embryo)
</code></pre>
<pre><code>## Call: mable.group() for grouped data
## Obj Class: mable 
## Input Data: nT 
## Dimension of data: 1 
## Optimal degree m: 13 
## P-value of Change-point: 9.925959e-07 
## Maximum loglikelihood: -107.318 
## MABLE of p: can be retrieved using name 'p' 
## Note: the optimal model degrees are selected by the method of change-point.
</code></pre>
<h2 id="contaminated-data-density-deconvolution">Contaminated Data–Density Deconvolution</h2>
<p>Consider the additive measurement error model \(Y = X + \epsilon\), where \(X\) has an unknown distribution \(F\), \(\epsilon\) has a known distribution \(G\), and \(X\) and \(\epsilon\) are independent. We want to estimate density \(f=F'\) based on independent observations, \(y_i = x_i + \epsilon_i\), \(i=1,\ldots,n\), of \(Y\), where \(x_i\)’s and \(\epsilon_i\)’s are unobservable. \texttt{mable.decon()} implements the method of @Guan-2019-mable-deconvolution and gives an estimate of the density \(f\) using the approximate Bernstein polynomial model.</p>
<h3 id="example-a-simulated-normal-dataset">Example: A Simulated Normal Dataset</h3>
<pre><code class="language-r">set.seed(123)
mu &lt;- 1; sig &lt;- 2; a &lt;- mu - sig*5; b &lt;- mu + sig*5;
gn &lt;- function(x) dnorm(x, 0, 1)
n &lt;- 50;
x &lt;- rnorm(n, mu, sig); e &lt;- rnorm(n); y &lt;- x + e;
</code></pre>
<pre><code class="language-r">decn &lt;- mable.decon(y, gn, interval = c(a,b), M = c(5, 50))
</code></pre>
<pre><code class="language-r">op &lt;- par(mfrow = c(2,2), lwd = 2)
plot(decn, which = &quot;likelihood&quot;)
plot(decn, which = &quot;change-point&quot;, lgd.x = &quot;right&quot;)
plot(xx&lt;-seq(a, b, length = 100), yy&lt;-dnorm(xx, mu, sig), type = &quot;l&quot;, xlab = &quot;x&quot;,
     ylab = &quot;Density&quot;, ylim = c(0, max(yy)*1.1))
plot(decn, which = &quot;density&quot;, add = TRUE, lty = 2, col = 2)
# kernel density based on pure data
lines(density(x), lty = 5, col = 4)
legend(&quot;topright&quot;, bty = &quot;n&quot;, lty = c(1,2,5), col = c(1,2,4), c(expression(f),     
    expression(hat(f)),  expression(tilde(f)[K])))
plot(xx, yy&lt;-pnorm(xx, mu, sig), type = &quot;l&quot;, xlab = &quot;x&quot;, ylab = &quot;Distribution Function&quot;)
plot(decn, which = &quot;cumulative&quot;, add = TRUE, lty = 2, col = 2)
legend(&quot;bottomright&quot;, bty = &quot;n&quot;, lty = c(1,2), col = c(1,2), c(expression(F), 
    expression(hat(F))))
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Simulated Normal Data"  />
<p class="caption">Simulated Normal Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<h2 id="interval-censored-data">Interval Censored Data</h2>
<p>When data are interval censored, the ``\texttt{interval2}’’ type observations are of the form \((l,u)\) which is the interval containing the event time. Data is uncensored if `5B(l = u)5B`, right censored if `5B(u =)5B` \texttt{Inf}  or `5B(u =)5B` \texttt{NA}, and  left censored data if `5B(l =0)5B`.</p>
<p>Let \(f(t)\) and \(F(t)=1-S(t)\) be the density and cumulative distribution functions of the event time, respectively, on \((0, \tau)\), where \(\tau\le \infty\). If \(\tau\) is unknown or \(\tau=\infty\), then  \(f(t)\) on \([0,\tau_n]\) can be approximated by \(fm(t; p)=\tau_n^{-1}\sum_{i=0}^m p_i\beta_{mi}(t/\tau_n)\), where \(p_i\ge 0\), \(i=0,\ldots,m\), \(\sum_{i=0}^mp_i=1-p_{m+1}\), and \(\tau_n\) is the largest observation, either uncensored time, or right endpoint of interval/left censored, or left endpoint of right censored time. So we can approximate \(S(t)\) on \([0,\tau]\) by \(Sm(t; p)=\sum_{i=0}^{m+1} p_i \bar B_{mi}(t/\tau)\), where  \(\bar B_{mi}(u)=1-\int_0^u\beta_{mj}(t)dt\), \(i=0,\ldots,m\), is the beta survival function with shapes \((i+1,m-i+1)\), \(\bar B_{m,m+1}(t)=1\), \(p_{m+1}=1-\pi\), and \(\pi=F(\tau_n)\). For data without right-censored time, \(p_{m+1}=1-\pi=0\). The search for optimal degree \(m\) among \texttt{M=c(m0,m1)} using the method of change-point is stopped if either \texttt{m1} is reached or the test for change-point results in a p-value \texttt{pval} smaller than \texttt{sig.level}. @Guan-SIM-2020 proposed a method, as a special case of a semiparametric regression model, for estimating \(p\) with an optimal degree \(m\). The method is implemented in R function \texttt{mable.ic()}.</p>
<h3 id="example-the-breast-cosmesis-data">Example: The Breast Cosmesis Data</h3>
<p>Consider the breast cosmesis data as described in @Finkelstein-and-Wolfe-1985-biom is used to study the cosmetic effects of cancer therapy. The time-to-breast-retractions in months ($T$) were  subject to interval censoring and were measured for 94 women among them 46 received radiation only ($X=0$) (25 right-censored, 3 left-censored and 18 interval censored) and 48 received radiation plus chemotherapy ($X=1$)  (13 right-censored, 2 left-censored and 33 interval censored). The right-censored event times were for those women who did not experienced cosmetic deterioration.</p>
<p>We fit the Breast Cosmesis Data as two-sample data separately.</p>
<pre><code class="language-r">head(cosmesis, 3)
</code></pre>
<pre><code>##   left right treat
## 1   45    NA    RT
## 2    6    10    RT
## 3    0     7    RT
</code></pre>
<pre><code class="language-r">bc.res0 &lt;- mable.ic(cosmesis[cosmesis$treat == &quot;RT&quot;,1:2], M = c(1,50), IC = &quot;none&quot;)
bc.res1 &lt;- mable.ic(cosmesis[cosmesis$treat == &quot;RCT&quot;,1:2], M = c(1,50), IC = &quot;none&quot;)
</code></pre>
<p>As the warning message suggested, we check the \texttt{pval}. The \texttt{pval} when the search stopped is 0.0452.</p>
<pre><code class="language-r">op &lt;- par(mfrow = c(2,2),lwd = 2)
plot(bc.res0, which = &quot;change-point&quot;, lgd.x = &quot;right&quot;)
plot(bc.res1, which = &quot;change-point&quot;, lgd.x = &quot;right&quot;)
plot(bc.res0, which = &quot;survival&quot;, xlab = &quot;Months&quot;, ylim = c(0,1), main = &quot;Radiation Only&quot;)
plot(bc.res1, which = &quot;survival&quot;, xlab = &quot;Months&quot;, main = &quot;Radiation and Chemotherapy&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Breast Cosmesis Data"  />
<p class="caption">Breast Cosmesis Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<h2 id="multivariate-data">Multivariate Data</h2>
<p>A \(d\)-variate density \(f\) on a hyperrectangle \([a,b]=[a_1,b_1]\times \cdots\times[a_d,b_d]\) can be approximated by a mixture of \(d\)-variate beta densities on \([a,b]\), \(\beta_{mj}(x; a, b)=\prod_{i=1}^d\beta_{m_i,j_i}[(x_i-a_i)/(b_i-a_i)]/(b_i-a_i)\), with proportions \(p(j_1,\ldots,j_d)\), \(0\le j_i\le m_i, i=1,\ldots,d\). Because all the marginal densities can be approximated by Bernstein polynomials, we can choose optimal degree \(m_i\) based on observations of the \(i\)-th component of \(x\). For the \(i\)-th marginal density, an optimal degree is selected using \texttt{mable()}. Then fit the data using EM algorithm with the selected optimal degrees \(m=(m_1,\ldots,m_d)\) to obtain a vector \(p\) of the mixture proportions \(p(j_1,\ldots,j_d)\), arranged in the column-major order of \(j = (j_1,\ldots,j_d)\), \((p_0,\ldots,p_{K-1})\), where \(K=\prod_{i=1}^d (m_i+1)\). The proposed method of @Wang-and-Guan-2019 is implemented by function \texttt{mable.mvar()}.</p>
<h3 id="example-the-old-faithful-data">Example: The Old Faithful Data</h3>
<pre><code class="language-r">data(faithful)
head(faithful, 3)
</code></pre>
<pre><code>##   eruptions waiting
## 1     3.600      79
## 2     1.800      54
## 3     3.333      74
</code></pre>
<pre><code class="language-r">a &lt;- c(0, 40); b &lt;- c(7, 110)
</code></pre>
<pre><code class="language-r">#faith2 &lt;- mable.mvar(faithful, M = c(60,30), interval = cbind(a,b))
faith2 &lt;- mable.mvar(faithful, M = c(46,19), search =FALSE, interval = cbind(a,b))
</code></pre>
<pre><code class="language-r">plot(faith2, which = &quot;density&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Density Estimate based on the Old Faithful Data"  />
<p class="caption">Density Estimate based on the Old Faithful Data</p>
</div>
The density surface for two-dimensional data can be plot using the \texttt{plot} method (see Figure \ref{fig:Old-Faithful-Data-plot}). The summarized results are given below.
<pre><code class="language-r">summary(faith2)
</code></pre>
<pre><code>## Call: mable.mvar() for multivariate data
## Obj Class: mable 
## Input Data: eruptions waiting 
## Dimension of data: 2 
## Optimal degrees:
##   eruptions waiting
## m        46      19
## P-value of Change-point: 
## Maximum loglikelihood: 507.5615 
## MABLE of p: can be retrieved using name 'p' 
## Note: the optimal model degrees are selected by the method of change-point.
</code></pre>
<p>For multivariate density, the model degree can be chosen based on marginal data. As in Section \ref{old-faithful-data-mme} we obtained \(m_b= (78,28)\) and \(\hat m=(122,34)\).</p>
<pre><code class="language-r">x&lt;-faithful
x1&lt;-faithful[,1]
x2&lt;-faithful[,2]
a&lt;-c(0, 40); b&lt;-c(7, 110)
mb&lt;-c(78,28)
m1&lt;-122                                                            
m2&lt;-34                                                          
</code></pre>
<pre><code class="language-r">oldfaith1&lt;- mable.mvar(faithful, M = mb, search =FALSE, interval = cbind(a,b))
oldfaith2&lt;- mable.mvar(faithful, M = c(m1,m2), search =FALSE, interval = cbind(a,b))
</code></pre>
<pre><code class="language-r">op&lt;-par(mfrow=c(1,2), cex=0.7)                                                                                              
plot(oldfaith1, which=&quot;density&quot;, contour=TRUE)
plot(oldfaith2, which=&quot;density&quot;, contour=TRUE, add=TRUE, lty=2, col=2)
plot(oldfaith1, which=&quot;cumulative&quot;, contour=TRUE)
plot(oldfaith2, which=&quot;cumulative&quot;, contour=TRUE, add=TRUE, lty=2, col=2)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="The Old Faithful data"  />
<p class="caption">The Old Faithful data</p>
</div>
<pre><code class="language-r">par(op)                                                                                                                       
</code></pre>
<h1 id="event-time-data-with-covariates">Event Time Data with Covariates</h1>
<p>Let \(T\) be an event time and \(X\) be an associated \(d\)-dimensional covariate with distribution \(H(x)\) on \(\cal{X}\). We denote the marginal and the conditional survival functions of \(T\), respectively, by
\(S(t) = \bar F(t)= 1- F(t)=\Pr(T &gt; t)\) and \(S(t | x) = \bar F(t | x)=  1- F(t |  x)=\Pr(T &gt; t |  X=x).\)
Let \(f(t |  x)\) denote the conditional density of a continuous \(T\) given \(X=x\). The conditional cumulative hazard function and odds ratio,   respectively,
\(\Lambda(t |  x)=-\log S(t |  x)\) and \(O(t |  x)={F(t |  x)}/S(t |  x)\).
We will consider the general situation where the event time is subject to interval censoring.  The observed data are \((X, Y)\), where \(Y=(Y_1,Y_2]\), \(0\le Y_1\le Y_2\le\infty\).
The reader is referred to @Huang-and-Wellner-1997 for a review and more references about interval censoring.
Special cases are right-censoring \(Y_2=\infty\), left-censoring \(Y_1=0\), and current status data.</p>
<p>Let \(f_0(\cdot)=f(\cdot\mid x_0)\), \(F_0(\cdot)=F(\cdot\mid x_0)\), and \(S_0(\cdot)=S(\cdot\mid x_0)\) be the baseline density, cumulative distribution, and survival functions, respectively. If the baseline density \(f_0\) has support or can be truncated by \([0,\tau]\) then
$$f_0(t)\approx f_m(t; \bm p)=\frac{1}{\tau}\sum_{j=0}^m p_j\beta_{mj}\Big(\frac{t}{\tau}\Big),\quad t\in[0,\tau],$$
where \(\bm p=\bm p(\bm x_0)=(p_0,\ldots, p_{m})^\top\), \(\sum_{j=0}^{m}p_j=1\), \(p_j\ge 0\), \(\beta_{mj}(t)=(m+1){m\choose  j}t^j(1-t)^{m-j}\).
Thus we have approximations $$F_0(t)\approx F_m(t; \bm p)= \sum_{j=0}^{m} p_j B_{mj}\Big(\frac{t}{\tau}\Big),\quad  t\in[0,\tau],$$
$$S_0(t)\approx S_m(t; \bm p)= \sum_{j=0}^{m} p_j \bar B_{mj}\Big(\frac{t}{\tau}\Big),\quad  t\in[0,\tau],$$
where \(B_{mj}(t)=\int_0^t\beta_{mj}(u)du\), and \(\bar B_{mj}(t)=1-B_{mj}(t)\), \(j=0,\dots,m\).</p>
<h2 id="accelerated-failure-time-model">Accelerated Failure Time Model</h2>
<p>The accelerated failure time (AFT) model can be specified as
\begin{equation}\label{eq: AFT model in terms of density}
f(t\mid x)=f(t\mid x;\gamma)=e^{\gamma^T x}f(te^{\gamma^T x}\mid 0),\quad t\in[0,\infty),
\end{equation}
where \(\gamma\in \mathbb{G}\subset \mathbb{R}^d\). Let \(\gamma_0\in \mathbb{G}\) be the true value of \(\gamma\).
The AFT model (\ref{eq: AFT model in terms of density}) is equivalent to
$$S(t\mid x;\gamma)=S(te^{\gamma^T x}\mid 0),\quad t\in[0,\infty).$$
Thus this is actually a scale regression model.
The AFT model can also be written as linear regression \(\log(T)=-\gamma^T x +\varepsilon\). It is clear that one can choose any \(x_0\) in \(\mathcal{X}\) as baseline by transform \(\tilde{x}=x-x_0\). If \(f_0(t)=f(t\mid x_0)\) has support \([0,\tau)\), \(\tau\le\infty\), then
\(f(t\mid x)\) has support \([0,\tau e^{-\gamma_0^T \tilde x})\).</p>
<!-- We define $\tau=\max\{\tau e^{-\gamma_0^T \tilde x}: x\in\mathcal{X}\}$ if $\tau_0<\infty$ and $\tau=\infty$ otherwise. -->
<p>The above AFT model can also be written as
$$f(t\mid x;\gamma)=e^{\gamma^T \tilde {x}} f_0(te^{\gamma^T \tilde {x}}), \quad S(t\mid x;\gamma)=S_0(te^{\gamma^T \tilde {x}}),$$
where   \(f_0(t)=f(t\mid x_0)\) and \(S_0(t)=S(t\mid x_0)=\int_t^\infty f_0(u)du\).</p>
<p>We choose \(\tau&gt;y_{(n)}= \max\{y_{i1}, y_{j2}: y_{j2}&lt;\infty;\, i,j=1,\dots,n\}\) so that \(S(\tau)\) and \(\max_{x\in\mathcal{X}} S(\tau\mid x)\) are believed very small.
@Guan-SIM-2023  proposed to approximate \(f_0(t)\) and \(S_0(t)\) on \([0,\tau]\), respectively, by
\begin{align*}
f_m(t; p)&amp;=\frac{1}{\tau}\sum_{j=0}^m p_j\beta_{mj}\Big(\frac{t}{\tau}\Big),\quad t\in[0,\tau];\
S_m(t; p)&amp;= \sum_{j=0}^{m} p_j \bar B_{mj}\Big(\frac{t}{\tau}\Big),\quad  t\in[0,\tau].
\end{align*}
Then \(f(t\mid x; \gamma)\) and \(S(t\mid x; \gamma)\)  can be approximated, respectively, by
\begin{align}\nonumber
f_m(t\mid x; \gamma, p)&amp;=e^{\gamma^T {x}}f_m\Big(te^{\gamma^T {x}}; p\Big)\
&amp;=
\frac{e^{\gamma^T {x}}}{\tau_0}\sum_{j=0}^m p_j\beta_{mj}\Big(e^{\gamma^T {x}}\frac{t}{\tau_0}\Big),\quad t\in[0,\tau_0e^{-\gamma^T {x}}];\\nonumber
S_m(t\mid x;\gamma,p)&amp;=S_m\Big(te^{\gamma^T {x}}; p\Big)\
&amp;=  \sum_{j=0}^{m} p_j\bar B_{mj}\Big(e^{\gamma^T {  x}}\frac{t}{\tau_0}\Big),\quad t\in[0,\tau_0e^{-\gamma^T {x}}].
\end{align}
@Guan-SIM-2023’s proposal is implemented by functions \texttt{mable.aft()} and \texttt{maple.aft()}.</p>
<h3 id="example-breast-cosmesis-data">Example: Breast Cosmesis Data</h3>
<pre><code class="language-r">library(mable)
g &lt;- 0.41 # Hanson and Johnson 2004, JCGS
aft.res&lt;-mable.aft(cbind(left, right) ~ treat, data = cosmesis, M =c(1, 30), g=.41,  
                   tau =100, x0=data.frame(treat = &quot;RCT&quot;))
</code></pre>
<pre><code class="language-r">summary(aft.res)
</code></pre>
<pre><code>## Call: mable.aft(cbind(left, right) ~ treat)
## Data: cosmesis 
## Obj Class: mable_reg 
## Dimension of response: 1 
## Dimension of covariate: 1 
## Optimal degree m: 6 
## P-value: 0.008966527 
## Maximum loglikelihood: -143.1529 
## MABLE of p: can be retrieved using name 'p' 
## 
##            Estimate  Std.Error    z value   Pr(&gt;|z|) Baseline x0
## treatRCT 0.57792280 0.13888899 4.16104112 0.00003168           1
## 
## Note: the optimal model degree is selected by the method of change-point.
</code></pre>
<pre><code class="language-r">op &lt;- par(mfrow = c(1,2), lwd = 1.5)
plot(x = aft.res, which = &quot;likelihood&quot;)
plot(x = aft.res, y = data.frame(treat = &quot;RT&quot;), which = &quot;survival&quot;, 
     type = &quot;l&quot;, col = 1, main = &quot;Survival Function&quot;)
plot(x = aft.res, y = data.frame(treat = &quot;RCT&quot;), which = &quot;survival&quot;, 
     lty = 2, col = 1, add = TRUE)
legend(&quot;topright&quot;, bty = &quot;n&quot;, lty = 1:2, col = 1, c(&quot;Radiation Only&quot;, 
    &quot;Radiation &amp; Chemotherapy&quot;), cex = .7)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="AFT Model Fit for Breast Cosmesis Data"  />
<p class="caption">AFT Model Fit for Breast Cosmesis Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<p>Alternatively we can use \texttt{mable.reg()}.</p>
<pre><code class="language-r">aft.res1 &lt;- mable.reg(cbind(left, right) ~ treat, data = cosmesis, model='aft', M = c(1, 30), 
      g=.41, tau=100, x0=data.frame(treat = &quot;RCT&quot;))
</code></pre>
<h2 id="proportional-hazards-model">Proportional Hazards Model</h2>
<p>Consider the Cox proportional hazard regression model [@Cox1972]
\begin{equation}\label{eq: Cox PH model-conditional survival function}
S(t |  x) =S(t | x; \gamma, f_0)=S_0(t)^{\exp(\gamma^T\tilde{x})},
\end{equation}
where \(\gamma\in \mathbb{G}  \subset \mathbb{R}^d\), \(\tilde{x} =x -x_0\), \(x_0\) is any fixed covariate value, \(f_0(\cdot)=f(\cdot | x_0)\) is the unknown baseline density and  \(S_0(t)=\int_t^\infty f_0(s)ds\). Define \(\tau=\inf\{t: F(t |  x_{0})=1\}\).
It is true that \(\tau\) is independent of \(x_0\), \(0&lt;\tau\le\infty\), and \(f(t |  x)\) have the same support \([0,\tau]\) for all \(x\in \cal{X}\).
Let \((x_i, y_i)=(x_i, (y_{i1}, y_{j2}])\), \(i=1,\dots,n\), be independent observations of \((X, Y)\) and
\(\tau_n\ge y_{(n)}=\max\{y_{i1}, y_{j2}: y_{j2}&lt;\infty;\, i,j=1,\dots,n\}\).
Given any \(x_0\), denote \(\pi=\pi(x_0)=1-S_0(\tau_n)\). For integer \(m\ge 1\) we define \(\mathbb{S}_m\equiv \{(u_0,\ldots,u_m)^T\in \mathbb{R}^{m+1}: u_i\ge 0, \sum_{i=0}^m u_i=1.\}.\)
@Guan-SIM-2020 propose to approximate \(f_0(t)\)   on \([0,\tau_n]\)  by \(f_m(t; p) = \tau_n^{-1}\sum_{i=0}^{m} p_i\beta_{mi}(t/\tau_n)\), where \(p=p(x_0)=(p_0,\ldots,p_{m+1})\)  are subject to constraints   \(p\in \mathbb{S}_{m+1}\) and \(p_{m+1}=1-\pi\).
Here the dependence of \(\pi\) and \(p\) on \(x_0\) will be suppressed.
If \(\pi&lt; 1\),  although we cannot estimate the values of \(f_0(t)\)  on \((\tau_n,\infty)\), we can put an arbitrary guess on them such as
\(f_m(t; p)=  p_{m+1} \alpha(t-\tau_n)\), \(t\in (\tau_n,\infty)\), where  \(\alpha(\cdot)\) is a density on \([0,\infty)\) such that \((1-\pi)\alpha(0)=(m+1)p_m/\tau_n\) so that \(f_m(t; p)\) is continuous at \(t=\tau_n\), e.g., \(\alpha(t)=\alpha(0)\exp[-\alpha(0)t]\).  If \(\tau\) is finite and known we choose \(\tau_n=\tau\) and specify \(p_{m+1}=0\). Otherwise,  we choose \(\tau_n=y_{(n)}\). For data without right-censoring or covariate
we also have to specify \(p_{m+1}=0\) due to its unidentifiability.</p>
<p>The above method is implemented in function \texttt{mable.ph()} which returns maximum approximate Bernstein likelihood estimates of \((\gamma, p)\) with an optimal model degree \(m\) and a prespecified \(m\),  respectively. With a efficient estimate of \(\gamma\) obtained using other method, \texttt{maple.ph()} can be used to get an optimal degree \(m\) and a mable of \(p\).</p>
<p>The \texttt{plot} method \texttt{plot.mable_reg()} for class \texttt{mable_reg} object returned by all the above functions produces graphs of the loglikelihoods at \(m\) in a set \texttt{M[1]:M[2]} of consecutive candidate model degrees, the likelihood ratios of change-point at \(m\) in \texttt{(M[1]+1):M[2]},  estimated density and survival function on the truncated \texttt{support}=$[0,\tau_n]$.</p>
<h3 id="example-ovarian-cancer-survival-data">Example: Ovarian Cancer Survival Data</h3>
<p>The Ovarian Cancer Survival Data is included in package \texttt{survival}.</p>
<pre><code class="language-r">library(survival)
futime2 &lt;- ovarian$futime
futime2[ovarian$fustat==0] &lt;- Inf
ovarian2 &lt;- data.frame(age = ovarian$age, futime1 = ovarian$futime, futime2 = futime2)
head(ovarian2, 3)
</code></pre>
<pre><code>##       age futime1 futime2
## 1 72.3315      59      59
## 2 74.4932     115     115
## 3 66.4658     156     156
</code></pre>
<pre><code class="language-r">ova&lt;-mable.ph(cbind(futime1, futime2) ~ age, data = ovarian2, M = c(2,35), 
              g = .16, x0=data.frame(age=35))
</code></pre>
<pre><code class="language-r">summary(ova)
</code></pre>
<pre><code>## Call: mable.ph(cbind(futime1, futime2) ~ age)
## Data: ovarian2 
## Obj Class: mable_reg 
## Dimension of response: 1 
## Dimension of covariate: 1 
## Optimal degree m: 23 
## P-value: 0.008999588 
## Maximum loglikelihood: -85.73586 
## MABLE of p: can be retrieved using name 'p' 
## 
##       Estimate  Std.Error    z value   Pr(&gt;|z|) Baseline x0
## age 1.7669e-01 1.0517e-02 1.6800e+01 2.4435e-63          35
## 
## Note: the optimal model degree is selected by the method of change-point.
</code></pre>
<pre><code class="language-r">op &lt;- par(mfrow = c(2,2))
plot(ova, which = &quot;likelihood&quot;)
plot(ova, which = &quot;change-point&quot;)
plot(ova, y=data.frame(age=60), which=&quot;survival&quot;, type=&quot;l&quot;, xlab=&quot;Days&quot;, main=&quot;Age = 60&quot;)
plot(ova, y=data.frame(age=65), which=&quot;survival&quot;, type=&quot;l&quot;, xlab=&quot;Days&quot;, main=&quot;Age = 65&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Ovarian Cancer Data"  />
<p class="caption">Ovarian Cancer Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<p>Alternatively we can use \texttt{mable.reg()}.</p>
<pre><code class="language-r">ova1 &lt;- mable.reg(cbind(futime1, futime2) ~ age, data = ovarian2, M = c(2,35))
</code></pre>
<h2 id="proportional-odds-model">Proportional Odds Model</h2>
<p>As an important alternative of the Cox proportional hazards regression model [@Cox1972] the proportional odds (PO) model [@McCullagh-JRSSB-1980; @Bennett-stats-Med-1983; @Bennett-app-stats-1983; @Pettitt-AS-1984] is defined by
\begin{equation}\label{eq: proportional odds model}
\frac{O(t|\bm x)}{O(t|\bm x_0)}= e^{\bm\gamma^\top\tilde{\bm x}}
\end{equation}
where \(\tilde{\bm x}=\bm x-\bm x_0\) and \(O(t|\bm x_0)\) is an unknown increasing baseline odds function on \((0, \infty)\) and \(\bm\gamma\) are unknown regression coefficients. If the baseline density \(f_0\) has support or can be truncated by \([0,\tau]\) then
$$f_0(t)\approx f_m(t; \bm p)=\frac{1}{\tau}\sum_{j=0}^m p_j\beta_{mj}\Big(\frac{t}{\tau}\Big),\quad t\in[0,\tau].$$</p>
<p>Therefore \(f(t\mid\bm x; \bm\gamma, f_0)\), \(F(t\mid\bm x; \bm\gamma, f_0)\), and \(S(t\mid\bm x; \bm\gamma, f_0)\)  can be approximated, respectively, by
\begin{align}\nonumber
f_m(t\mid\bm x; \bm\gamma, \bm p)
&amp;=
\frac{e^{\bm\gamma^\top \tilde{\bm x}}f_m(t;\bm p)}
{[e^{\bm\gamma^\top\tilde{\bm x}}+(1-e^{\bm\gamma^\top\tilde{\bm x}})S_m(t;\bm p)]^{2}}=
\frac{e^{\bm\gamma^\top\tilde{\bm x}}f_m(t;\bm p)}
{[1+(e^{\bm\gamma^\top\tilde{\bm x}}-1)F_m(t;\bm p)]^{2}},\\nonumber
F_m(t|\bm x; \bm\gamma, \bm p)
=&amp;
\frac{e^{\bm\gamma^\top\tilde{\bm x}} F_m(t;\bm p)}
{e^{\bm\gamma^\top\tilde{\bm x}}+(1-e^{\bm\gamma^\top\tilde{\bm x}})S_m(t;\bm p)}=\frac{e^{\bm\gamma^\top\tilde{\bm x}} F_m(t;\bm p)}
{1+(e^{\bm\gamma^\top\tilde{\bm x}}-1)F_m(t;\bm p)},\\nonumber
S_m(t\mid\bm x; \bm\gamma, \bm p)&amp;=\frac{S_m(t;\bm p)}
{e^{\bm\gamma^\top\tilde{\bm x}}+(1-e^{\bm\gamma^\top\tilde{\bm x}})S_m(t;\bm p)}=\frac{S_m(t;\bm p)}
{1+(e^{\bm\gamma^\top\tilde{\bm x}}-1)F_m(t;\bm p)}.
\end{align}</p>
<h3 id="example-hiv-infection-time-data">Example: HIV Infection time Data</h3>
<p>The data set is contained in R package \texttt{Epi}. This is an interval-censored data. The semiparametric methods (package \texttt{icenReg}) are available for PH and PO (but not AFT) models based on interval-censored data. The estimated survival functions are plotted in Fig \ref{fig:HIV-infection-time-data-po}.</p>
<pre><code class="language-r">## Interval-censored data on times to HIV infection. Carstensen (1996)
## see also Lawless and Babineau (2006)
# inspection times(months): started in Dec. 31, 1980,
it&lt;-c(0, 12, 16, 27, 45, 76, 101, Inf)
# observed frequencies d[l,r] in interval (it[l], it[r]], 0&lt;=l&lt;r&lt;=7
x&lt;-c(24, 0, 4, 2,1,4,0,10,0,3,0,3,1,0,5,0,4,0,2,1,1,0,61,8,15,22,34,92)
n&lt;-sum(x)
d&lt;-matrix(c(24,rep(0,6),
            0, 4, rep(0,5),
            2,1,4,0,0,0,0,
            0,10,0,3,0,0,0,
            0,3,1,0,5,0,0,
            0,4,0,2,1,1,0,
            0,61,8,15,22,34,92), nrow=7, ncol=7)
# See Fay's tutorial
#  us: whether visited the US.
# byr: birth year
# age: age at entry
# age=hiv$bth+30, 
# pyr: Annual number of sexual partners.
library(Epi)
data(hivDK)
l&lt;-as.numeric(hivDK$well-hivDK$entry)
l.na&lt;-l
l[is.na(l)]&lt;-0
r&lt;- as.numeric(hivDK$ill - hivDK$entry)
r.na&lt;-r
r[is.na(r)]&lt;-Inf
hiv&lt;-data.frame(l,r, us=hivDK$us, byr=hivDK$bth+1950, age=30-hivDK$bth, pyr=hivDK$pyr)
## icenReg
library(icenReg)
#library(interval)
phfit&lt;-ic_sp(cbind(l,r)~us+age+pyr, data=hiv, bs_samples =100, model = 'ph')
pofit&lt;-ic_sp(cbind(l,r)~us+age+pyr, data=hiv, bs_samples =100, model = 'po')
</code></pre>
<pre><code class="language-r"># MABLE
require(mable)
gama&lt;-phfit$coefficients
tau&lt;-5500 # truncation interval [0,tau]
# Mable PH model
x0&lt;-data.frame(us=0,age=72,pyr=0)
#mblph&lt;-mable.ph(cbind(l,r)~us+age+pyr, data=hiv, M=c(2,40), g=gama, x0=x0, tau=tau)
mblph&lt;-mable.ph(cbind(l,r)~us+age+pyr, data=hiv, M=22, g=gama, x0=x0, tau=tau)
# Mable PO model:  
mblpo&lt;-mable.po(cbind(l,r)~us+age+pyr, data=hiv, M=c(3,20), g=gama, x0=x0, tau=tau)
# Mable AFT model: m=12 selected from M=c(5,50)
mblaft&lt;-mable.aft(cbind(l,r)~us+age+pyr, data=hiv, M=12, g=NULL, x0=x0, tau=tau,
                  controls=mable.ctrl(sig.level=0.05, eps.em=1e-7, maxit.em=20000))
</code></pre>
<pre><code class="language-r">newdata=data.frame(us=0:1,age=mean(hiv$age),pyr=mean(hiv$pyr))
par(mfrow=c(2,2),lwd=1.5, cex=.7, mar=c(4,4,1,1), oma=c(0,0,3,1))
# upper-left panel
plot(c(0,3057), c(.6,1), type=&quot;n&quot;, xlab=&quot;Days&quot;, ylab=&quot;Probability&quot;)
lines(phfit, y=newdata[1,], lty=3, col=&quot;brown&quot;)
lines(phfit, y=newdata[2,], lty=4, col=4)
plot(mblpo, y=newdata[1,], which=&quot;survival&quot;, add=TRUE, col=1, lty=1)
plot(mblpo, y=newdata[2,], which=&quot;survival&quot;, add=TRUE, col=2, lty=2)
legend(&quot;topright&quot;, lty=c(1:4), col=c(1:2,&quot;brown&quot;,4), bty=&quot;n&quot;, 
       legend=paste0(c(&quot;mable-po: us = &quot;, &quot;mable-po: us = &quot;, 
                       &quot;semip-ph: us = &quot;, &quot;semip-ph: us = &quot;),  c(rep(newdata$us,2))))
# upper-right panel
plot(c(0,3057), c(.6,1), type=&quot;n&quot;, xlab=&quot;Days&quot;, ylab=&quot;Probability&quot;)
lines(pofit, y=newdata[1,], lty=3, col=&quot;brown&quot;)
lines(pofit, y=newdata[2,], lty=4, col=4)
plot(mblpo, y=newdata[1,], which=&quot;survival&quot;, add=TRUE, col=1, lty=1)
plot(mblpo, y=newdata[2,], which=&quot;survival&quot;, add=TRUE, col=2, lty=2)
legend(&quot;topright&quot;, lty=c(1:4), col=c(1:2,&quot;brown&quot;,4), bty=&quot;n&quot;, 
       legend=paste0(c(&quot;mable-po: us = &quot;, &quot;mable-po: us = &quot;, 
                       &quot;semip-po: us = &quot;, &quot;semip-po: us = &quot;),  c(rep(newdata$us,2))))
# lower-left panel
#newdata2=data.frame(us=mean(hiv$us),age=c(31,50),pyr=mean(hiv$pyr))
plot(c(0,3057), c(.6,1), type=&quot;n&quot;, xlab=&quot;Days&quot;, ylab=&quot;Probability&quot;)
plot(mblpo, y=newdata[1,], which=&quot;survival&quot;, add=TRUE, col=1, lty=1)
plot(mblpo, y=newdata[2,], which=&quot;survival&quot;, add=TRUE, col=2, lty=2)
plot(mblph, y=newdata[1,], which=&quot;survival&quot;, add=TRUE, col=&quot;brown&quot;, lty=3)
plot(mblph, y=newdata[2,], which=&quot;survival&quot;, add=TRUE, col=4, lty=4)
legend(&quot;topright&quot;, lty=1:4, col=c(1,2,&quot;brown&quot;,4), bty=&quot;n&quot;, 
       legend=paste0(c(&quot;mable-po: us = &quot;, &quot;mable-po: us = &quot;, 
                       &quot;mable-ph: us = &quot;, &quot;mable-ph: us = &quot;),  c(rep(newdata$us,2))))
# lower-right panel
plot(c(0,3057), c(.6,1), type=&quot;n&quot;, xlab=&quot;Days&quot;, ylab=&quot;Probability&quot;)
plot(mblpo, y=newdata[1,], which=&quot;survival&quot;, add=TRUE, col=1, lty=1)
plot(mblpo, y=newdata[2,], which=&quot;survival&quot;, add=TRUE, col=2, lty=2)
plot(mblaft, y=newdata[1,], which=&quot;survival&quot;, add=TRUE, col=&quot;brown&quot;, lty=3)
plot(mblaft, y=newdata[2,], which=&quot;survival&quot;, add=TRUE, col=4, lty=4)
legend(&quot;topright&quot;, lty=1:4, col=c(1,2,&quot;brown&quot;,4), bty=&quot;n&quot;, 
       legend=paste0(c(&quot;mable-po: us = &quot;, &quot;mable-po: us = &quot;, 
                       &quot;mable-aft: us = &quot;, &quot;mable-aft: us = &quot;),  c(rep(newdata$us,2))))
mtext(&quot;Survival Curves: Visited US or Not&quot;, side=3, line=1, outer=TRUE, cex=1, font=2)
</code></pre>
<p><img src="data:image/png;base64,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" alt="Estimated survival functions for HIV infection time data with \texttt{us}=0 and \texttt{us}=1, and average values of \texttt{age} and \texttt{pyr}. MABLE PO model is compared with semiparametric PH model (upper-left), semiparametric PO model (upper-right), and MABLE AFT model (lower-right).\label{fig:HIV-infection-time-data-po}" /></p>
<h1 id="two-sample-data">Two-sample Data</h1>
<p>In addition to the AFT, PH and PO regression models with single binary covariate, other two-sample semiparametric models can be estimated using the maximum approximate Bernstein/Beta likelihood method.</p>
<h2 id="density-ratio-model">Density Ratio Model</h2>
<p>Two-sample density ratio(DR) model
(see for example, @QinZhang1997 and @Qin-and-Zhang-2005) is useful for fitting case-control data.
Suppose that the densities \(f_0\) and \(f_1\) of \(X_0\) and \(X_1\), respectively, satisfy the following density ratio model (see @CHENG-and-CHU-Bernoulli-2004 and @Qin-and-Zhang-2005, for example)
\begin{equation}\label{eq: exponential tilting model}
f_1(x)=f(x;\bm\alpha)=f_0(x)\exp{\bm\alpha^T \tilde r(x)},
\end{equation}
where \(\bm\alpha=(\alpha_0,\ldots,\alpha_d)^T \in\mathcal{A}\subset R^{d+1}\), and \(\tilde r(x)=(1, r<sup>T(x))</sup>T\) with linearly independent components. @Guan-arXiv-2021-mable-dr-model proposed to approximate the \emph{baseline} density \(f_0\) by Bernstein polynomial and to estimate \(f_0\) and \(\bm\alpha\) using the maximum approximate Bernstein/Beta likelihood estimation. This method is implemented by function \texttt{mable.dr()} and \texttt{maple.dr()} in which \(\bm\alpha\) is a given estimated value such as the one obtained by the logistic regression as described in @QinZhang1997 and @Qin-and-Zhang-2005.</p>
<h3 id="example-coronary-heart-disease-data">Example: Coronary Heart Disease Data</h3>
<pre><code class="language-r"># Hosmer and Lemeshow (1989):                                           
# ages and the status of coronary disease (CHD) of 100 subjects         
x&lt;-c(20, 23, 24, 25, 26, 26, 28, 28, 29, 30, 30, 30, 30, 30, 32,        
32, 33, 33, 34, 34, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 39,         
40, 41, 41, 42, 42, 42, 43, 43, 44, 44, 45, 46, 47, 47, 48, 49,         
49, 50, 51, 52, 55, 57, 57, 58, 60, 64)                                 
y&lt;-c(25, 30, 34, 36, 37, 39, 40, 42, 43, 44, 44, 45, 46, 47, 48,        
48, 49, 50, 52, 53, 53, 54, 55, 55, 56, 56, 56, 57, 57, 57, 57,         
58, 58, 59, 59, 60, 61, 62, 62, 63, 64, 65, 69) 
a&lt;-20; b&lt;-70
regr&lt;-function(x) cbind(1,x)  
</code></pre>
<pre><code class="language-r">chd.mable&lt;-mable.dr(x, y, M=c(1, 15), regr, interval = c(a,b))   
</code></pre>
<pre><code class="language-r">z&lt;-seq(a,b,length=512)
f0hat&lt;-dmixbeta(z, p=chd.mable$p, interval=c(a, b))
rf&lt;-function(x) regr((x-a)/(b-a))
f1hat&lt;-dtmixbeta(z, p=chd.mable$p, alpha=chd.mable$alpha, 
                 interval=c(a, b), regr=regr)
op&lt;-par(mfrow=c(1,2),lwd=1.2, cex=.7, mar=c(5,4,1,1))
hist(x, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;Age&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b), ylim=c(0,.055), main=&quot;Control&quot;)
lines(z, f0hat, lty=1, col=1)
hist(y, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;Age&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b), ylim=c(0,.055), main=&quot;Case&quot;)
lines(z, f1hat, lty=1, col=1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="DR Model Fit for Coronary Heart Disease  Data"  />
<p class="caption">DR Model Fit for Coronary Heart Disease  Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<h3 id="example-pancreatic-cancer-biomarker-data">Example: Pancreatic Cancer Biomarker Data</h3>
<p>For the logarithmic levels of CA 19-9 of the Pancreatic Cancer Data (@Wieand-et-al-1989-bka), the control group is used as baseline because the optimal model degree is smaller that the one using case as baseline.</p>
<pre><code class="language-r">data(pancreas)
head(pancreas,3)
</code></pre>
<pre><code>##   ca199 ca125 status
## 1  28.0  13.3      0
## 2  15.5  11.1      0
## 3   8.2  16.7      0
</code></pre>
<pre><code class="language-r">x&lt;-log(pancreas$ca199[pancreas$status==0])
y&lt;-log(pancreas$ca199[pancreas$status==1])
a&lt;-min(x,y); b&lt;-max(x,y)
M&lt;-c(1,29)
regr&lt;-function(x) cbind(1,x,x^2)                                            
</code></pre>
<pre><code class="language-r">m=maple.dr(x, y, M, regr=regr, interval=c(a,b), controls=mable.ctrl(sig.level=.001))$m
pc.mable&lt;-mable.dr(x, y, M=m, regr=regr, interval=c(a,b),
                  controls=mable.ctrl(sig.level=1/length(c(x,y))))
#pc.mable   
</code></pre>
<pre><code class="language-r">z&lt;-seq(a,b,length=512)
# baseline is &quot;case&quot;
f1hat&lt;-dmixbeta(z, p=pc.mable$p, interval=c(a, b))
rf&lt;-function(x) regr((x-a)/(b-a))
f0hat&lt;-dtmixbeta(z, p=pc.mable$p, alpha=pc.mable$alpha, 
                 interval=c(a, b), regr=regr)
op&lt;-par(mfrow=c(1,2),lwd=1.2, cex=.7, mar=c(5,4,1,1))
hist(x, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;log(CA19-9)&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b),  main=&quot;Control&quot;)
lines(z, f0hat, lty=1, col=1)
hist(y, freq=F, col = &quot;light grey&quot;, border = &quot;white&quot;, xlab=&quot;log(CA19-9)&quot;, 
  ylab=&quot;Density&quot;, xlim=c(a,b), ylim=c(0,.5), main=&quot;Case&quot;)
lines(z, f1hat, lty=1, col=1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="DR Model Fit for Pancreatic Cancer Biomarker Data"  />
<p class="caption">DR Model Fit for Pancreatic Cancer Biomarker Data</p>
</div>
<pre><code class="language-r">par(op)
</code></pre>
<h2 id="references">References</h2>
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/combine/npm/katex/dist/katex.min.js,npm/katex/dist/contrib/auto-render.min.js,npm/@xiee/utils/js/render-katex.js" defer></script>
</body>
</html>
